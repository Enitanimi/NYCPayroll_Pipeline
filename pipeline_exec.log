2024-09-07 12:06:39,220 - ERROR - Error initializing BlobServiceClient: 'NoneType' object has no attribute 'rstrip'


2024-09-07 12:06:39,221 - ERROR - Error in the extraction process: 'NoneType' object has no attribute 'rstrip'


2024-09-07 12:15:16,357 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75b33665-6d0a-11ef-9b58-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-07 12:15:17,912 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '19e305d0-901e-005c-3a17-01fdcf000000'
    'x-ms-client-request-id': '75b33665-6d0a-11ef-9b58-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sat, 07 Sep 2024 11:15:17 GMT'


2024-09-07 12:15:17,939 - INFO - No new files found in Dataset/raw_payroll_data


2024-09-07 12:15:17,940 - INFO - No new files to process.


2024-09-07 12:25:58,176 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f44141f1-6d0b-11ef-b9d7-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-07 12:25:59,081 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '56704a8c-b01e-004b-5718-0154c4000000'
    'x-ms-client-request-id': 'f44141f1-6d0b-11ef-b9d7-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sat, 07 Sep 2024 11:25:58 GMT'


2024-09-07 12:25:59,094 - ERROR - Error downloading the latest file from ADLS: [Errno 2] No such file or directory: 'Dataset/Raw_Dataset./local_data\\nycpayroll_2020.csv'


2024-09-07 12:25:59,097 - ERROR - Error in the extraction process: [Errno 2] No such file or directory: 'Dataset/Raw_Dataset./local_data\\nycpayroll_2020.csv'


2024-09-07 12:43:55,469 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '765ee0cf-6d0e-11ef-8c81-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-07 12:43:56,915 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '109135de-201e-0059-551b-012f14000000'
    'x-ms-client-request-id': '765ee0cf-6d0e-11ef-8c81-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sat, 07 Sep 2024 11:43:56 GMT'


2024-09-07 12:43:56,921 - ERROR - Error downloading the latest file from ADLS: [Errno 2] No such file or directory: 'All_Dataset/Raw_Dataset./local_data\\nycpayroll_2020.csv'


2024-09-07 12:43:56,922 - ERROR - Error in the extraction process: [Errno 2] No such file or directory: 'All_Dataset/Raw_Dataset./local_data\\nycpayroll_2020.csv'


2024-09-07 12:59:19,844 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9d578b4e-6d10-11ef-97e1-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-07 12:59:21,062 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'afbe8061-d01e-0000-6c1d-01a897000000'
    'x-ms-client-request-id': '9d578b4e-6d10-11ef-97e1-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sat, 07 Sep 2024 11:59:20 GMT'


2024-09-07 12:59:21,085 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9e14bbda-6d10-11ef-b28b-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-07 12:59:22,053 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Sat, 07 Sep 2024 11:25:34 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2FCA387630"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'afbe8098-d01e-0000-211d-01a897000000'
    'x-ms-client-request-id': '9e14bbda-6d10-11ef-b28b-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sat, 07 Sep 2024 11:59:20 GMT'


2024-09-07 12:59:22,061 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset/local_data\nycpayroll_2020.csv


2024-09-07 12:59:22,064 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9eaa4d32-6d10-11ef-9018-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-07 12:59:22,360 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sat, 07 Sep 2024 11:59:22 GMT'
    'ETag': '"0x8DCCF3483166580"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'afbe81d9-d01e-0000-0d1d-01a897000000'
    'x-ms-client-request-id': '9eaa4d32-6d10-11ef-9018-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Sat, 07 Sep 2024 11:59:21 GMT'


2024-09-07 12:59:22,367 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9ed876db-6d10-11ef-985c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-07 12:59:22,699 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'afbe822b-d01e-0000-4c1d-01a897000000'
    'x-ms-client-request-id': '9ed876db-6d10-11ef-985c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Sat, 07 Sep 2024 11:59:22 GMT'


2024-09-07 12:59:22,702 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-07 12:59:22,704 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-08 07:49:30,372 - INFO - Starting data transformation


2024-09-08 07:49:34,159 - INFO - dim_date data generated and saved!


2024-09-08 07:49:34,322 - INFO - Transformed data saved to All_Dataset\Cleaned_Dataset\nycpayroll_2020.csv


2024-09-08 12:31:24,171 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e0f9a9bc-6dd5-11ef-98a8-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:31:26,902 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '68821b2d-101e-001f-0be2-011b93000000'
    'x-ms-client-request-id': 'e0f9a9bc-6dd5-11ef-98a8-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:31:26 GMT'


2024-09-08 12:31:26,910 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e29bdc31-6dd5-11ef-b7ef-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:31:27,287 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '68821be6-101e-001f-2ee2-011b93000000'
    'x-ms-client-request-id': 'e29bdc31-6dd5-11ef-b7ef-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Sun, 08 Sep 2024 11:31:27 GMT'


2024-09-08 12:31:27,292 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e2d60560-6dd5-11ef-aaf1-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:31:27,632 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '68821c28-101e-001f-6ee2-011b93000000'
    'x-ms-client-request-id': 'e2d60560-6dd5-11ef-aaf1-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:31:28 GMT'


2024-09-08 12:31:27,637 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset/local_data\raw_payroll_data


2024-09-08 12:31:27,640 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e30b10d4-6dd5-11ef-a888-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:31:29,364 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8b91ed94-801e-0022-21e2-016d88000000'
    'x-ms-client-request-id': 'e30b10d4-6dd5-11ef-a888-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Sun, 08 Sep 2024 11:31:29 GMT'


2024-09-08 12:31:29,368 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:8b91ed94-801e-0022-21e2-016d88000000
Time:2024-09-08T11:31:30.4856507Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:8b91ed94-801e-0022-21e2-016d88000000
Time:2024-09-08T11:31:30.4856507Z</Message></Error>


2024-09-08 12:31:29,370 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:8b91ed94-801e-0022-21e2-016d88000000
Time:2024-09-08T11:31:30.4856507Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:8b91ed94-801e-0022-21e2-016d88000000
Time:2024-09-08T11:31:30.4856507Z</Message></Error>


2024-09-08 12:36:10,617 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8bb614a9-6dd6-11ef-b595-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:14,679 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a9602b15-b01e-0029-5de3-0196e3000000'
    'x-ms-client-request-id': '8bb614a9-6dd6-11ef-b595-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:36:12 GMT'


2024-09-08 12:36:14,696 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8e246003-6dd6-11ef-88fe-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:15,718 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Sun, 08 Sep 2024 11:35:51 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCFFA64584D50"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a960304a-b01e-0029-03e3-0196e3000000'
    'x-ms-client-request-id': '8e246003-6dd6-11ef-88fe-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:36:15 GMT'


2024-09-08 12:36:15,725 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset/local_data\nycpayroll_2020.csv


2024-09-08 12:36:15,728 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8ec21b19-6dd6-11ef-919e-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:16,107 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 08 Sep 2024 11:36:17 GMT'
    'ETag': '"0x8DCCFFA73DA0424"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a96032b4-b01e-0029-60e3-0196e3000000'
    'x-ms-client-request-id': '8ec21b19-6dd6-11ef-919e-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:36:16 GMT'


2024-09-08 12:36:16,112 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8efc8b69-6dd6-11ef-9a64-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:16,469 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a96033a4-b01e-0029-6ae3-0196e3000000'
    'x-ms-client-request-id': '8efc8b69-6dd6-11ef-9a64-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:36:16 GMT'


2024-09-08 12:36:16,470 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-08 12:36:16,472 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-08 12:36:33,581 - INFO - Starting extraction process...


2024-09-08 12:36:33,584 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '99669d30-6dd6-11ef-81c0-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:35,963 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b63db6fa-501e-006c-71e3-014300000000'
    'x-ms-client-request-id': '99669d30-6dd6-11ef-81c0-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:36:36 GMT'


2024-09-08 12:36:35,967 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9ad254d7-6dd6-11ef-9a9d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:36,498 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b63db749-501e-006c-3ae3-014300000000'
    'x-ms-client-request-id': '9ad254d7-6dd6-11ef-9a9d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Sun, 08 Sep 2024 11:36:37 GMT'


2024-09-08 12:36:36,501 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9b23942c-6dd6-11ef-8a67-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:36,995 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'b63db785-501e-006c-71e3-014300000000'
    'x-ms-client-request-id': '9b23942c-6dd6-11ef-8a67-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:36:37 GMT'


2024-09-08 12:36:37,000 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset/local_data\raw_payroll_data


2024-09-08 12:36:37,003 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9b7024d8-6dd6-11ef-a310-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:36:38,885 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '0a55c8b5-101e-006d-73e3-011cdc000000'
    'x-ms-client-request-id': '9b7024d8-6dd6-11ef-a310-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Sun, 08 Sep 2024 11:36:39 GMT'


2024-09-08 12:36:38,893 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:0a55c8b5-101e-006d-73e3-011cdc000000
Time:2024-09-08T11:36:39.9552564Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:0a55c8b5-101e-006d-73e3-011cdc000000
Time:2024-09-08T11:36:39.9552564Z</Message></Error>


2024-09-08 12:36:38,894 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:0a55c8b5-101e-006d-73e3-011cdc000000
Time:2024-09-08T11:36:39.9552564Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:0a55c8b5-101e-006d-73e3-011cdc000000
Time:2024-09-08T11:36:39.9552564Z</Message></Error>


2024-09-08 12:36:38,896 - ERROR - ETL pipeline failed: One of the request inputs is not valid.
RequestId:0a55c8b5-101e-006d-73e3-011cdc000000
Time:2024-09-08T11:36:39.9552564Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:0a55c8b5-101e-006d-73e3-011cdc000000
Time:2024-09-08T11:36:39.9552564Z</Message></Error>


2024-09-08 12:40:50,782 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '32b3c99c-6dd7-11ef-b96f-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:40:52,118 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '339894e6-701e-0044-3ae3-0122a8000000'
    'x-ms-client-request-id': '32b3c99c-6dd7-11ef-b96f-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:40:52 GMT'


2024-09-08 12:40:52,128 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '338146ae-6dd7-11ef-a158-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:40:52,606 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Sun, 08 Sep 2024 11:40:25 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCFFB07D83224"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '33989538-701e-0044-80e3-0122a8000000'
    'x-ms-client-request-id': '338146ae-6dd7-11ef-a158-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:40:52 GMT'


2024-09-08 12:40:52,614 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset/local_data\nycpayroll_2020.csv


2024-09-08 12:40:52,617 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '33cc01b0-6dd7-11ef-b00a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:40:52,972 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 08 Sep 2024 11:40:54 GMT'
    'ETag': '"0x8DCCFFB18E4A8E4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '339895a4-701e-0044-63e3-0122a8000000'
    'x-ms-client-request-id': '33cc01b0-6dd7-11ef-b00a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:40:53 GMT'


2024-09-08 12:40:52,975 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '340291e8-6dd7-11ef-99ef-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:40:53,404 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '339895fd-701e-0044-32e3-0122a8000000'
    'x-ms-client-request-id': '340291e8-6dd7-11ef-99ef-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:40:53 GMT'


2024-09-08 12:40:53,406 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-08 12:40:53,407 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-08 12:40:58,521 - INFO - Starting extraction process...


2024-09-08 12:40:58,524 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '37513781-6dd7-11ef-b14c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:41:00,371 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1ea49a32-201e-0014-6ce3-01e0f8000000'
    'x-ms-client-request-id': '37513781-6dd7-11ef-b14c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:41:01 GMT'


2024-09-08 12:41:00,377 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '386c11b7-6dd7-11ef-a4d0-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:41:00,774 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1ea49aad-201e-0014-59e3-01e0f8000000'
    'x-ms-client-request-id': '386c11b7-6dd7-11ef-a4d0-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Sun, 08 Sep 2024 11:41:01 GMT'


2024-09-08 12:41:00,777 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '38a8f69a-6dd7-11ef-9eaa-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:41:01,388 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1ea49aea-201e-0014-15e3-01e0f8000000'
    'x-ms-client-request-id': '38a8f69a-6dd7-11ef-9eaa-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 11:41:02 GMT'


2024-09-08 12:41:01,404 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset/local_data\raw_payroll_data


2024-09-08 12:41:01,408 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '390967d5-6dd7-11ef-80d3-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 12:41:03,231 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2d5d0af2-201e-0066-1de3-01e7b7000000'
    'x-ms-client-request-id': '390967d5-6dd7-11ef-80d3-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Sun, 08 Sep 2024 11:41:03 GMT'


2024-09-08 12:41:03,234 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:2d5d0af2-201e-0066-1de3-01e7b7000000
Time:2024-09-08T11:41:04.2814326Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:2d5d0af2-201e-0066-1de3-01e7b7000000
Time:2024-09-08T11:41:04.2814326Z</Message></Error>


2024-09-08 12:41:03,235 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:2d5d0af2-201e-0066-1de3-01e7b7000000
Time:2024-09-08T11:41:04.2814326Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:2d5d0af2-201e-0066-1de3-01e7b7000000
Time:2024-09-08T11:41:04.2814326Z</Message></Error>


2024-09-08 12:41:03,237 - ERROR - ETL pipeline failed: One of the request inputs is not valid.
RequestId:2d5d0af2-201e-0066-1de3-01e7b7000000
Time:2024-09-08T11:41:04.2814326Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:2d5d0af2-201e-0066-1de3-01e7b7000000
Time:2024-09-08T11:41:04.2814326Z</Message></Error>


2024-09-08 20:30:49,519 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'da6199bb-6e18-11ef-bb20-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 20:30:57,229 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fb879a90-201e-002b-5825-02285b000000'
    'x-ms-client-request-id': 'da6199bb-6e18-11ef-bb20-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 19:30:57 GMT'


2024-09-08 20:30:57,235 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'df0f30da-6e18-11ef-a5d2-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 20:30:58,096 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fb879bc1-201e-002b-7a25-02285b000000'
    'x-ms-client-request-id': 'df0f30da-6e18-11ef-a5d2-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Sun, 08 Sep 2024 19:30:58 GMT'


2024-09-08 20:30:58,099 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'df92e6ba-6e18-11ef-9700-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 20:30:58,958 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'fb879ce4-201e-002b-1125-02285b000000'
    'x-ms-client-request-id': 'df92e6ba-6e18-11ef-9700-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 19:30:59 GMT'


2024-09-08 20:30:58,985 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset/local_data\raw_payroll_data


2024-09-08 20:30:58,988 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e01a554e-6e18-11ef-8cd7-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 20:31:00,703 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '1bf28498-e01e-001b-6025-029694000000'
    'x-ms-client-request-id': 'e01a554e-6e18-11ef-8cd7-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Sun, 08 Sep 2024 19:31:01 GMT'


2024-09-08 20:31:00,776 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:1bf28498-e01e-001b-6025-029694000000
Time:2024-09-08T19:31:02.0028107Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:1bf28498-e01e-001b-6025-029694000000
Time:2024-09-08T19:31:02.0028107Z</Message></Error>


2024-09-08 20:31:00,778 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:1bf28498-e01e-001b-6025-029694000000
Time:2024-09-08T19:31:02.0028107Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:1bf28498-e01e-001b-6025-029694000000
Time:2024-09-08T19:31:02.0028107Z</Message></Error>


2024-09-08 23:20:12,274 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '83ef24ee-6e30-11ef-aa51-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:20:14,288 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a77343d9-901e-002e-2b3d-02fa80000000'
    'x-ms-client-request-id': '83ef24ee-6e30-11ef-aa51-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:20:13 GMT'


2024-09-08 23:20:14,294 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '85234e2e-6e30-11ef-ad8d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:20:14,717 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Sun, 08 Sep 2024 22:09:44 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD052F1F444B0"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a773441d-901e-002e-693d-02fa80000000'
    'x-ms-client-request-id': '85234e2e-6e30-11ef-ad8d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:20:14 GMT'


2024-09-08 23:20:14,722 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset/local_data\nycpayroll_2020.csv


2024-09-08 23:20:14,723 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8564bfb7-6e30-11ef-99c4-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:20:15,107 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 08 Sep 2024 22:20:15 GMT'
    'ETag': '"0x8DCD05469DE1658"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a7734447-901e-002e-0f3d-02fa80000000'
    'x-ms-client-request-id': '8564bfb7-6e30-11ef-99c4-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:20:14 GMT'


2024-09-08 23:20:15,110 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '859fde5f-6e30-11ef-8f9a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:20:15,728 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'a7734474-901e-002e-363d-02fa80000000'
    'x-ms-client-request-id': '859fde5f-6e30-11ef-8f9a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:20:15 GMT'


2024-09-08 23:20:15,731 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-08 23:20:15,732 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-08 23:26:47,257 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6f5ca0fa-6e31-11ef-a220-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:26:49,242 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '49423e99-b01e-0064-163e-02590f000000'
    'x-ms-client-request-id': '6f5ca0fa-6e31-11ef-a220-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:26:49 GMT'


2024-09-08 23:26:49,248 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '708c7950-6e31-11ef-bbe4-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:26:49,660 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '49423ef2-b01e-0064-683e-02590f000000'
    'x-ms-client-request-id': '708c7950-6e31-11ef-bbe4-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Sun, 08 Sep 2024 22:26:49 GMT'


2024-09-08 23:26:49,662 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '70cba5a8-6e31-11ef-a78a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:26:50,059 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '49423f53-b01e-0064-443e-02590f000000'
    'x-ms-client-request-id': '70cba5a8-6e31-11ef-a78a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:26:50 GMT'


2024-09-08 23:26:50,063 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset/local_data\raw_payroll_data


2024-09-08 23:26:50,065 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '71092436-6e31-11ef-97e6-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:26:51,518 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '8edb808e-701e-0036-403e-0225e7000000'
    'x-ms-client-request-id': '71092436-6e31-11ef-97e6-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Sun, 08 Sep 2024 22:26:51 GMT'


2024-09-08 23:26:51,520 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:8edb808e-701e-0036-403e-0225e7000000
Time:2024-09-08T22:26:51.5422723Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:8edb808e-701e-0036-403e-0225e7000000
Time:2024-09-08T22:26:51.5422723Z</Message></Error>


2024-09-08 23:26:51,521 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:8edb808e-701e-0036-403e-0225e7000000
Time:2024-09-08T22:26:51.5422723Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:8edb808e-701e-0036-403e-0225e7000000
Time:2024-09-08T22:26:51.5422723Z</Message></Error>


2024-09-08 23:36:15,220 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c1e4cbb2-6e32-11ef-941b-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:17,262 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '32de47b8-601e-0067-283f-02b86b000000'
    'x-ms-client-request-id': 'c1e4cbb2-6e32-11ef-941b-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:36:16 GMT'


2024-09-08 23:36:17,272 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c31e0457-6e32-11ef-9030-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:18,369 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Sun, 08 Sep 2024 22:35:58 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD0569C12A07C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '32de47e2-601e-0067-4e3f-02b86b000000'
    'x-ms-client-request-id': 'c31e0457-6e32-11ef-9030-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:36:16 GMT'


2024-09-08 23:36:18,468 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset/local_data\nycpayroll_2020.csv


2024-09-08 23:36:18,470 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c3d4dc8e-6e32-11ef-af6a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:19,429 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 08 Sep 2024 22:36:18 GMT'
    'ETag': '"0x8DCD056A8522438"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '32de488f-601e-0067-683f-02b86b000000'
    'x-ms-client-request-id': 'c3d4dc8e-6e32-11ef-af6a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:36:18 GMT'


2024-09-08 23:36:19,432 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c4678d42-6e32-11ef-ba5c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:20,219 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '32de490c-601e-0067-5b3f-02b86b000000'
    'x-ms-client-request-id': 'c4678d42-6e32-11ef-ba5c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:36:19 GMT'


2024-09-08 23:36:20,221 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-08 23:36:20,222 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-08 23:36:36,115 - INFO - Starting extraction process...


2024-09-08 23:36:36,120 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ce59dd25-6e32-11ef-a776-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:38,038 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '790a0a7b-c01e-001c-113f-02faf7000000'
    'x-ms-client-request-id': 'ce59dd25-6e32-11ef-a776-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:36:37 GMT'


2024-09-08 23:36:38,046 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cf7fe9ec-6e32-11ef-8e17-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:38,666 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '790a0b32-c01e-001c-3e3f-02faf7000000'
    'x-ms-client-request-id': 'cf7fe9ec-6e32-11ef-8e17-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Sun, 08 Sep 2024 22:36:37 GMT'


2024-09-08 23:36:38,668 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'cfded053-6e32-11ef-8a29-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:39,269 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '790a0bf2-c01e-001c-763f-02faf7000000'
    'x-ms-client-request-id': 'cfded053-6e32-11ef-8a29-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Sun, 08 Sep 2024 22:36:38 GMT'


2024-09-08 23:36:39,274 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset/local_data\raw_payroll_data


2024-09-08 23:36:39,277 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd03b9324-6e32-11ef-9228-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-08 23:36:41,313 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '40ee2a8b-b01e-0039-3c3f-02538b000000'
    'x-ms-client-request-id': 'd03b9324-6e32-11ef-9228-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Sun, 08 Sep 2024 22:36:40 GMT'


2024-09-08 23:36:41,315 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:40ee2a8b-b01e-0039-3c3f-02538b000000
Time:2024-09-08T22:36:41.3656717Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:40ee2a8b-b01e-0039-3c3f-02538b000000
Time:2024-09-08T22:36:41.3656717Z</Message></Error>


2024-09-08 23:36:41,317 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:40ee2a8b-b01e-0039-3c3f-02538b000000
Time:2024-09-08T22:36:41.3656717Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:40ee2a8b-b01e-0039-3c3f-02538b000000
Time:2024-09-08T22:36:41.3656717Z</Message></Error>


2024-09-08 23:36:41,318 - ERROR - ETL pipeline failed: One of the request inputs is not valid.
RequestId:40ee2a8b-b01e-0039-3c3f-02538b000000
Time:2024-09-08T22:36:41.3656717Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:40ee2a8b-b01e-0039-3c3f-02538b000000
Time:2024-09-08T22:36:41.3656717Z</Message></Error>


2024-09-09 07:46:25,370 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3bb594a9-6e77-11ef-9ad2-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:27,869 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '65141ffb-501e-006c-4a83-024300000000'
    'x-ms-client-request-id': '3bb594a9-6e77-11ef-9ad2-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 06:46:27 GMT'


2024-09-09 07:46:27,880 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d34917f-6e77-11ef-9b26-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:28,485 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Mon, 09 Sep 2024 06:04:58 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD09555CC63A8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '65142096-501e-006c-6383-024300000000'
    'x-ms-client-request-id': '3d34917f-6e77-11ef-9b26-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 06:46:28 GMT'


2024-09-09 07:46:28,490 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset/local_data\nycpayroll_2020.csv


2024-09-09 07:46:28,493 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3d9214c6-6e77-11ef-b8b3-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:29,101 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 09 Sep 2024 06:46:29 GMT'
    'ETag': '"0x8DCD09B2271BA14"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '65142199-501e-006c-5b83-024300000000'
    'x-ms-client-request-id': '3d9214c6-6e77-11ef-b8b3-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 06:46:28 GMT'


2024-09-09 07:46:29,104 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3def68d1-6e77-11ef-ac34-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:29,508 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '6514226c-501e-006c-2584-024300000000'
    'x-ms-client-request-id': '3def68d1-6e77-11ef-ac34-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 06:46:29 GMT'


2024-09-09 07:46:29,510 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-09 07:46:29,511 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-09 07:46:29,539 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3e31f1d9-6e77-11ef-8808-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:31,142 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7f28dbcf-601e-0015-1a84-02bf24000000'
    'x-ms-client-request-id': '3e31f1d9-6e77-11ef-8808-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 06:46:31 GMT'


2024-09-09 07:46:31,146 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3f2720b8-6e77-11ef-aff9-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:31,554 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7f28dc8d-601e-0015-4e84-02bf24000000'
    'x-ms-client-request-id': '3f2720b8-6e77-11ef-aff9-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Mon, 09 Sep 2024 06:46:31 GMT'


2024-09-09 07:46:31,556 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3f6594f9-6e77-11ef-abfa-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:31,960 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7f28dd37-601e-0015-7284-02bf24000000'
    'x-ms-client-request-id': '3f6594f9-6e77-11ef-abfa-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 06:46:32 GMT'


2024-09-09 07:46:31,964 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset\raw_payroll_data


2024-09-09 07:46:31,966 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data


2024-09-09 07:46:31,967 - INFO - Archive blob path: Dataset/archived_payroll_data/raw_payroll_data


2024-09-09 07:46:31,969 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3fa4a293-6e77-11ef-b272-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 07:46:33,557 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'd6a657c9-e01e-0056-3c84-025978000000'
    'x-ms-client-request-id': '3fa4a293-6e77-11ef-b272-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Mon, 09 Sep 2024 06:46:33 GMT'


2024-09-09 07:46:33,560 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:d6a657c9-e01e-0056-3c84-025978000000
Time:2024-09-09T06:46:34.3119567Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:d6a657c9-e01e-0056-3c84-025978000000
Time:2024-09-09T06:46:34.3119567Z</Message></Error>


2024-09-09 07:46:33,562 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:d6a657c9-e01e-0056-3c84-025978000000
Time:2024-09-09T06:46:34.3119567Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:d6a657c9-e01e-0056-3c84-025978000000
Time:2024-09-09T06:46:34.3119567Z</Message></Error>


2024-09-09 09:14:48,964 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '94e5c439-6e83-11ef-96c1-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:14:50,936 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54c0eb42-c01e-001c-7f90-02faf7000000'
    'x-ms-client-request-id': '94e5c439-6e83-11ef-96c1-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:14:51 GMT'


2024-09-09 09:14:50,945 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '96143ba7-6e83-11ef-ad57-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:14:51,288 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54c0eb7e-c01e-001c-3790-02faf7000000'
    'x-ms-client-request-id': '96143ba7-6e83-11ef-ad57-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Mon, 09 Sep 2024 08:14:52 GMT'


2024-09-09 09:14:51,294 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '96495e16-6e83-11ef-b79d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:14:51,642 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54c0ebae-c01e-001c-6290-02faf7000000'
    'x-ms-client-request-id': '96495e16-6e83-11ef-b79d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:14:52 GMT'


2024-09-09 09:14:51,646 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset\raw_payroll_data


2024-09-09 09:14:51,647 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data


2024-09-09 09:14:51,647 - INFO - Archive blob path: Dataset/archived_payroll_data/raw_payroll_data


2024-09-09 09:14:51,649 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '967fae30-6e83-11ef-a100-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:14:53,410 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '991c14a0-e01e-001b-7790-029694000000'
    'x-ms-client-request-id': '967fae30-6e83-11ef-a100-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Mon, 09 Sep 2024 08:14:54 GMT'


2024-09-09 09:14:53,412 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:991c14a0-e01e-001b-7790-029694000000
Time:2024-09-09T08:14:54.3801939Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:991c14a0-e01e-001b-7790-029694000000
Time:2024-09-09T08:14:54.3801939Z</Message></Error>


2024-09-09 09:14:53,413 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:991c14a0-e01e-001b-7790-029694000000
Time:2024-09-09T08:14:54.3801939Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:991c14a0-e01e-001b-7790-029694000000
Time:2024-09-09T08:14:54.3801939Z</Message></Error>


2024-09-09 09:24:04,618 - INFO - Starting extraction process...


2024-09-09 09:24:04,621 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e0184825-6e84-11ef-8ccb-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:24:07,021 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54fa2c38-501e-0043-4891-024ecb000000'
    'x-ms-client-request-id': 'e0184825-6e84-11ef-8ccb-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:24:07 GMT'


2024-09-09 09:24:07,025 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e1873e32-6e84-11ef-b3cd-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:24:07,680 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Mon, 09 Sep 2024 08:20:14 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD0A83B53E4B4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54fa2c72-501e-0043-7d91-024ecb000000'
    'x-ms-client-request-id': 'e1873e32-6e84-11ef-b3cd-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:24:07 GMT'


2024-09-09 09:24:07,687 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset\nycpayroll_2020.csv


2024-09-09 09:24:07,688 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-09 09:24:07,689 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2020.csv


2024-09-09 09:24:07,690 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e1ecc8f0-6e84-11ef-aeda-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:24:08,185 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 09 Sep 2024 08:24:09 GMT'
    'ETag': '"0x8DCD0A8C6F5E788"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54fa2cff-501e-0043-8091-024ecb000000'
    'x-ms-client-request-id': 'e1ecc8f0-6e84-11ef-aeda-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:24:08 GMT'


2024-09-09 09:24:08,187 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e238a574-6e84-11ef-863c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:24:08,797 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '54fa2d53-501e-0043-4891-024ecb000000'
    'x-ms-client-request-id': 'e238a574-6e84-11ef-863c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:24:08 GMT'


2024-09-09 09:24:08,799 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-09 09:24:08,799 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-09 09:24:08,800 - INFO - Starting transformation process...


2024-09-09 09:24:08,801 - INFO - Starting data transformation


2024-09-09 09:24:08,803 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset/local_data'


2024-09-09 09:24:08,804 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset/local_data'


2024-09-09 09:30:14,279 - INFO - Starting extraction process...


2024-09-09 09:30:14,281 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bc6e2cbe-6e85-11ef-adb7-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:30:16,932 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '337a146b-b01e-0006-1592-029b28000000'
    'x-ms-client-request-id': 'bc6e2cbe-6e85-11ef-adb7-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:30:17 GMT'


2024-09-09 09:30:16,937 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be033ae4-6e85-11ef-abb4-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:30:17,433 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '337a14d1-b01e-0006-7692-029b28000000'
    'x-ms-client-request-id': 'be033ae4-6e85-11ef-abb4-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Mon, 09 Sep 2024 08:30:17 GMT'


2024-09-09 09:30:17,435 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be4f5c1e-6e85-11ef-a329-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:30:17,841 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '337a15a6-b01e-0006-4792-029b28000000'
    'x-ms-client-request-id': 'be4f5c1e-6e85-11ef-a329-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:30:18 GMT'


2024-09-09 09:30:17,847 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset\raw_payroll_data


2024-09-09 09:30:17,849 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data


2024-09-09 09:30:17,850 - INFO - Archive blob path: Dataset/archived_payroll_data/raw_payroll_data


2024-09-09 09:30:17,853 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'be8f1c67-6e85-11ef-a923-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:30:19,686 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '2081536c-901e-0063-7892-02356c000000'
    'x-ms-client-request-id': 'be8f1c67-6e85-11ef-a923-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Mon, 09 Sep 2024 08:30:19 GMT'


2024-09-09 09:30:19,687 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:2081536c-901e-0063-7892-02356c000000
Time:2024-09-09T08:30:20.6332425Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:2081536c-901e-0063-7892-02356c000000
Time:2024-09-09T08:30:20.6332425Z</Message></Error>


2024-09-09 09:30:19,688 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:2081536c-901e-0063-7892-02356c000000
Time:2024-09-09T08:30:20.6332425Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:2081536c-901e-0063-7892-02356c000000
Time:2024-09-09T08:30:20.6332425Z</Message></Error>


2024-09-09 09:30:19,689 - ERROR - ETL pipeline failed: One of the request inputs is not valid.
RequestId:2081536c-901e-0063-7892-02356c000000
Time:2024-09-09T08:30:20.6332425Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:2081536c-901e-0063-7892-02356c000000
Time:2024-09-09T08:30:20.6332425Z</Message></Error>


2024-09-09 09:35:07,819 - INFO - Starting extraction process...


2024-09-09 09:35:07,824 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6b6526d2-6e86-11ef-bee3-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:35:09,905 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '02a330bb-401e-004f-1593-02d9c3000000'
    'x-ms-client-request-id': '6b6526d2-6e86-11ef-bee3-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:35:09 GMT'


2024-09-09 09:35:09,913 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6ca40678-6e86-11ef-a47d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:35:10,613 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Mon, 09 Sep 2024 08:33:51 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD0AA21FEFD68"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '02a3315e-401e-004f-2993-02d9c3000000'
    'x-ms-client-request-id': '6ca40678-6e86-11ef-a47d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:35:10 GMT'


2024-09-09 09:35:10,628 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset\nycpayroll_2020.csv


2024-09-09 09:35:10,629 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-09 09:35:10,630 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2020.csv


2024-09-09 09:35:10,632 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6d11c777-6e86-11ef-a68d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:35:11,115 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 09 Sep 2024 08:35:11 GMT'
    'ETag': '"0x8DCD0AA520FF7FC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '02a33222-401e-004f-4893-02d9c3000000'
    'x-ms-client-request-id': '6d11c777-6e86-11ef-a68d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:35:11 GMT'


2024-09-09 09:35:11,119 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6d5bb71b-6e86-11ef-9837-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-09 09:35:11,724 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '02a332a6-401e-004f-4993-02d9c3000000'
    'x-ms-client-request-id': '6d5bb71b-6e86-11ef-9837-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Mon, 09 Sep 2024 08:35:11 GMT'


2024-09-09 09:35:11,727 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-09 09:35:11,728 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-09 09:35:11,728 - INFO - Starting transformation process...


2024-09-09 09:35:11,730 - INFO - Starting data transformation


2024-09-09 09:35:11,732 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-09 09:35:11,733 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-09 09:54:18,705 - INFO - Starting data transformation


2024-09-09 09:54:20,437 - INFO - dim_date data generated and saved!


2024-09-09 09:54:20,597 - INFO - Transformed data saved to All_Dataset\Cleaned_Dataset\nycpayroll_2020.csv


2024-09-09 10:18:16,309 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-09 10:18:16,426 - INFO - State start


2024-09-09 10:18:16,500 - INFO -   Scheduler at:     tcp://127.0.0.1:57769


2024-09-09 10:18:16,501 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-09 10:18:16,502 - INFO - Registering Worker plugin shuffle


2024-09-09 10:18:16,576 - INFO -         Start Nanny at: 'tcp://127.0.0.1:57772'


2024-09-09 10:18:20,840 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-09 10:18:20,902 - INFO - State start


2024-09-09 10:18:21,072 - INFO -   Scheduler at:     tcp://127.0.0.1:57778


2024-09-09 10:18:21,073 - INFO -   dashboard at:  http://127.0.0.1:57777/status


2024-09-09 10:18:21,074 - INFO - Registering Worker plugin shuffle


2024-09-09 10:18:21,156 - INFO -         Start Nanny at: 'tcp://127.0.0.1:57781'


2024-09-09 10:18:21,162 - ERROR - Failed to start process

Traceback (most recent call last):
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\nanny.py", line 452, in instantiate
    result = await self.process.start()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\nanny.py", line 748, in start
    await self.process.start()
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\process.py", line 55, in _call_and_set_future
    res = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\process.py", line 215, in _start
    process.start()
  File "C:\Program Files\Python312\Lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
                  ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\multiprocessing\context.py", line 337, in _Popen
    return Popen(process_obj)
           ^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\multiprocessing\popen_spawn_win32.py", line 46, in __init__
    prep_data = spawn.get_preparation_data(process_obj._name)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\multiprocessing\spawn.py", line 164, in get_preparation_data
    _check_not_importing_main()
  File "C:\Program Files\Python312\Lib\multiprocessing\spawn.py", line 140, in _check_not_importing_main
    raise RuntimeError('''
RuntimeError: 
        An attempt has been made to start a new process before the
        current process has finished its bootstrapping phase.

        This probably means that you are not using fork to start your
        child processes and you have forgotten to use the proper idiom
        in the main module:

            if __name__ == '__main__':
                freeze_support()
                ...

        The "freeze_support()" line can be omitted if the program
        is not going to be frozen to produce an executable.

        To fix this issue, refer to the "Safe importing of main module"
        section in https://docs.python.org/3/library/multiprocessing.html
        
2024-09-09 10:18:21,209 - INFO - Closing Nanny at 'tcp://127.0.0.1:57781'. Reason: nanny-instantiate-failed


2024-09-09 21:05:24,066 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-09 21:05:24,110 - INFO - State start


2024-09-09 21:05:24,138 - INFO - Found stale lock file and directory 'C:\\Users\\oluwa\\AppData\\Local\\Temp\\dask-scratch-space\\scheduler-3xd9ax8f', purging


2024-09-09 21:05:24,143 - INFO - Found stale lock file and directory 'C:\\Users\\oluwa\\AppData\\Local\\Temp\\dask-scratch-space\\scheduler-vd9g6g6n', purging


2024-09-09 21:05:24,205 - INFO -   Scheduler at:     tcp://127.0.0.1:61583


2024-09-09 21:05:24,207 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-09 21:05:24,208 - INFO - Registering Worker plugin shuffle


2024-09-09 21:05:24,280 - INFO -         Start Nanny at: 'tcp://127.0.0.1:61586'


2024-09-09 21:05:27,771 - INFO -       Start worker at:      tcp://127.0.0.1:61592


2024-09-09 21:05:27,773 - INFO -          Listening to:      tcp://127.0.0.1:61592


2024-09-09 21:05:27,774 - INFO -           Worker name:                          0


2024-09-09 21:05:27,775 - INFO -          dashboard at:            127.0.0.1:61593


2024-09-09 21:05:27,775 - INFO - Waiting to connect to:      tcp://127.0.0.1:61583


2024-09-09 21:05:27,776 - INFO - -------------------------------------------------


2024-09-09 21:05:27,777 - INFO -               Threads:                          4


2024-09-09 21:05:27,782 - INFO -                Memory:                  19.84 GiB


2024-09-09 21:05:27,793 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-pw6ujmc0


2024-09-09 21:05:27,795 - INFO - -------------------------------------------------


2024-09-09 21:05:27,808 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:61592', name: 0, status: init, memory: 0, processing: 0>


2024-09-09 21:05:27,817 - INFO - Starting worker compute stream, tcp://127.0.0.1:61592


2024-09-09 21:05:27,819 - INFO - Starting Worker plugin shuffle


2024-09-09 21:05:27,821 - INFO - Starting established connection to tcp://127.0.0.1:61594


2024-09-09 21:05:27,822 - INFO -         Registered to:      tcp://127.0.0.1:61583


2024-09-09 21:05:27,829 - INFO - -------------------------------------------------


2024-09-09 21:05:27,842 - INFO - Starting established connection to tcp://127.0.0.1:61583


2024-09-09 21:05:27,861 - INFO - Receive client connection: Client-d8266ef5-6ee6-11ef-b89c-f4a4751e46e5


2024-09-09 21:05:27,863 - INFO - Starting established connection to tcp://127.0.0.1:61595


2024-09-09 21:05:27,866 - INFO - Dask client initialized with 1 worker.


2024-09-09 21:05:27,893 - INFO - Connected to Snowflake successfully.


2024-09-09 21:05:27,894 - ERROR - Error loading data into Snowflake: Invalid file path or buffer object type: <class 'tuple'>


2024-09-09 21:05:28,247 - INFO - Retire worker addresses (0,)


2024-09-09 21:05:28,249 - INFO - Closing Nanny at 'tcp://127.0.0.1:61586'. Reason: nanny-close


2024-09-09 21:05:28,250 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-09 21:05:28,251 - INFO - Stopping worker at tcp://127.0.0.1:61592. Reason: nanny-close


2024-09-09 21:05:28,252 - INFO - Removing Worker plugin shuffle


2024-09-09 21:05:28,255 - INFO - Received 'close-stream' from tcp://127.0.0.1:61594; closing.


2024-09-09 21:05:28,255 - INFO - Connection to tcp://127.0.0.1:61583 has been closed.


2024-09-09 21:05:28,263 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:61592', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725912328.2632632')


2024-09-09 21:05:28,264 - INFO - Lost all workers


2024-09-09 21:05:28,739 - INFO - Closing scheduler. Reason: unknown


2024-09-09 21:05:28,740 - INFO - Scheduler closing all comms


2024-09-09 21:10:22,628 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-09 21:10:22,665 - INFO - State start


2024-09-09 21:10:22,715 - INFO -   Scheduler at:     tcp://127.0.0.1:61612


2024-09-09 21:10:22,717 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-09 21:10:22,718 - INFO - Registering Worker plugin shuffle


2024-09-09 21:10:22,778 - INFO -         Start Nanny at: 'tcp://127.0.0.1:61615'


2024-09-09 21:10:25,142 - INFO -       Start worker at:      tcp://127.0.0.1:61620


2024-09-09 21:10:25,143 - INFO -          Listening to:      tcp://127.0.0.1:61620


2024-09-09 21:10:25,144 - INFO -           Worker name:                          0


2024-09-09 21:10:25,144 - INFO -          dashboard at:            127.0.0.1:61621


2024-09-09 21:10:25,144 - INFO - Waiting to connect to:      tcp://127.0.0.1:61612


2024-09-09 21:10:25,146 - INFO - -------------------------------------------------


2024-09-09 21:10:25,146 - INFO -               Threads:                          4


2024-09-09 21:10:25,146 - INFO -                Memory:                  19.84 GiB


2024-09-09 21:10:25,148 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-eosfha01


2024-09-09 21:10:25,148 - INFO - -------------------------------------------------


2024-09-09 21:10:25,155 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:61620', name: 0, status: init, memory: 0, processing: 0>


2024-09-09 21:10:25,160 - INFO - Starting worker compute stream, tcp://127.0.0.1:61620


2024-09-09 21:10:25,161 - INFO - Starting Worker plugin shuffle


2024-09-09 21:10:25,161 - INFO - Starting established connection to tcp://127.0.0.1:61622


2024-09-09 21:10:25,167 - INFO -         Registered to:      tcp://127.0.0.1:61612


2024-09-09 21:10:25,170 - INFO - -------------------------------------------------


2024-09-09 21:10:25,171 - INFO - Starting established connection to tcp://127.0.0.1:61612


2024-09-09 21:10:25,231 - INFO - Receive client connection: Client-8b08d95b-6ee7-11ef-87fc-f4a4751e46e5


2024-09-09 21:10:25,232 - INFO - Starting established connection to tcp://127.0.0.1:61623


2024-09-09 21:10:25,234 - INFO - Dask client initialized with 1 worker.


2024-09-09 21:10:25,252 - INFO - Connected to Snowflake successfully.


2024-09-09 21:10:25,253 - ERROR - Error loading data into Snowflake: Invalid file path or buffer object type: <class 'tuple'>


2024-09-09 21:10:25,269 - INFO - Retire worker addresses (0,)


2024-09-09 21:10:25,271 - INFO - Closing Nanny at 'tcp://127.0.0.1:61615'. Reason: nanny-close


2024-09-09 21:10:25,271 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-09 21:10:25,273 - INFO - Stopping worker at tcp://127.0.0.1:61620. Reason: nanny-close


2024-09-09 21:10:25,276 - INFO - Removing Worker plugin shuffle


2024-09-09 21:10:25,281 - INFO - Received 'close-stream' from tcp://127.0.0.1:61622; closing.


2024-09-09 21:10:25,281 - INFO - Connection to tcp://127.0.0.1:61612 has been closed.


2024-09-09 21:10:25,282 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:61620', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725912625.2823105')


2024-09-09 21:10:25,284 - INFO - Lost all workers


2024-09-09 21:10:25,588 - INFO - Closing scheduler. Reason: unknown


2024-09-09 21:10:25,589 - INFO - Scheduler closing all comms


2024-09-09 21:19:49,339 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-09 21:19:49,374 - INFO - State start


2024-09-09 21:19:49,421 - INFO -   Scheduler at:     tcp://127.0.0.1:64518


2024-09-09 21:19:49,422 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-09 21:19:49,422 - INFO - Registering Worker plugin shuffle


2024-09-09 21:19:49,470 - INFO -         Start Nanny at: 'tcp://127.0.0.1:64521'


2024-09-09 21:19:51,815 - INFO -       Start worker at:      tcp://127.0.0.1:64526


2024-09-09 21:19:51,816 - INFO -          Listening to:      tcp://127.0.0.1:64526


2024-09-09 21:19:51,817 - INFO -           Worker name:                          0


2024-09-09 21:19:51,817 - INFO -          dashboard at:            127.0.0.1:64527


2024-09-09 21:19:51,818 - INFO - Waiting to connect to:      tcp://127.0.0.1:64518


2024-09-09 21:19:51,819 - INFO - -------------------------------------------------


2024-09-09 21:19:51,820 - INFO -               Threads:                          4


2024-09-09 21:19:51,820 - INFO -                Memory:                  19.84 GiB


2024-09-09 21:19:51,821 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-fn9x23xu


2024-09-09 21:19:51,821 - INFO - -------------------------------------------------


2024-09-09 21:19:51,828 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:64526', name: 0, status: init, memory: 0, processing: 0>


2024-09-09 21:19:51,832 - INFO - Starting worker compute stream, tcp://127.0.0.1:64526


2024-09-09 21:19:51,833 - INFO - Starting Worker plugin shuffle


2024-09-09 21:19:51,833 - INFO - Starting established connection to tcp://127.0.0.1:64528


2024-09-09 21:19:51,834 - INFO -         Registered to:      tcp://127.0.0.1:64518


2024-09-09 21:19:51,835 - INFO - -------------------------------------------------


2024-09-09 21:19:51,837 - INFO - Starting established connection to tcp://127.0.0.1:64518


2024-09-09 21:19:51,873 - INFO - Receive client connection: Client-dcd1f7a1-6ee8-11ef-bb18-f4a4751e46e5


2024-09-09 21:19:51,874 - INFO - Starting established connection to tcp://127.0.0.1:64529


2024-09-09 21:19:51,879 - INFO - Dask client initialized with 1 worker.


2024-09-09 21:19:51,898 - INFO - Connected to Snowflake successfully.


2024-09-09 21:19:51,898 - ERROR - Error loading data into Snowflake: [Errno 13] Permission denied: 'All_Dataset/Cleaned_Dataset'


2024-09-09 21:19:51,927 - INFO - Retire worker addresses (0,)


2024-09-09 21:19:51,929 - INFO - Closing Nanny at 'tcp://127.0.0.1:64521'. Reason: nanny-close


2024-09-09 21:19:51,931 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-09 21:19:51,932 - INFO - Stopping worker at tcp://127.0.0.1:64526. Reason: nanny-close


2024-09-09 21:19:51,934 - INFO - Removing Worker plugin shuffle


2024-09-09 21:19:51,936 - INFO - Received 'close-stream' from tcp://127.0.0.1:64528; closing.


2024-09-09 21:19:51,936 - INFO - Connection to tcp://127.0.0.1:64518 has been closed.


2024-09-09 21:19:51,938 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:64526', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1725913191.9376996')


2024-09-09 21:19:51,941 - INFO - Lost all workers


2024-09-09 21:19:52,206 - INFO - Closing scheduler. Reason: unknown


2024-09-09 21:19:52,206 - INFO - Scheduler closing all comms


2024-09-10 09:31:31,767 - INFO - Starting extraction process...


2024-09-10 09:31:31,771 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '15079b06-6f4f-11ef-b15a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 09:31:34,425 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '89376b4b-901e-0001-625b-03f74b000000'
    'x-ms-client-request-id': '15079b06-6f4f-11ef-b15a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 08:31:33 GMT'


2024-09-10 09:31:34,440 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '169f2813-6f4f-11ef-b52a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 09:31:34,895 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 10 Sep 2024 08:26:00 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD17233D54050"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '89376c1f-901e-0001-305b-03f74b000000'
    'x-ms-client-request-id': '169f2813-6f4f-11ef-b52a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 08:31:34 GMT'


2024-09-10 09:31:34,906 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset\nycpayroll_2020.csv


2024-09-10 09:31:34,908 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-10 09:31:34,909 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2020.csv


2024-09-10 09:31:34,914 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '16e77429-6f4f-11ef-820e-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 09:31:35,654 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Tue, 10 Sep 2024 08:31:35 GMT'
    'ETag': '"0x8DCD172FB650FB4"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '89376d05-901e-0001-0c5b-03f74b000000'
    'x-ms-client-request-id': '16e77429-6f4f-11ef-820e-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 08:31:34 GMT'


2024-09-10 09:31:35,663 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1759b23f-6f4f-11ef-855d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 09:31:36,038 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '89376e87-901e-0001-7f5b-03f74b000000'
    'x-ms-client-request-id': '1759b23f-6f4f-11ef-855d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 08:31:35 GMT'


2024-09-10 09:31:36,041 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-10 09:31:36,042 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-10 09:31:36,042 - INFO - Starting transformation process...


2024-09-10 09:31:36,044 - INFO - Starting data transformation


2024-09-10 09:31:36,047 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-10 09:31:36,049 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-10 17:12:03,816 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6b0345b6-6f8f-11ef-be7f-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 17:12:31,055 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7b3fa893-6f8f-11ef-b2dc-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 17:13:03,491 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '348f99c9-e01e-001b-349c-039694000000'
    'x-ms-client-request-id': '7b3fa893-6f8f-11ef-b2dc-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 16:12:55 GMT'


2024-09-10 17:13:03,515 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8e989a5a-6f8f-11ef-ada4-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 17:13:08,799 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '348fa0b0-e01e-001b-389c-039694000000'
    'x-ms-client-request-id': '8e989a5a-6f8f-11ef-ada4-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Tue, 10 Sep 2024 16:13:03 GMT'


2024-09-10 17:13:08,811 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '91c0ad0a-6f8f-11ef-88eb-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 17:13:12,497 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '348fa709-e01e-001b-719c-039694000000'
    'x-ms-client-request-id': '91c0ad0a-6f8f-11ef-88eb-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 16:13:09 GMT'


2024-09-10 17:13:12,515 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset/local_data\raw_payroll_data


2024-09-10 17:13:12,524 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '93f74064-6f8f-11ef-b79b-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 17:13:19,466 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '5dbb7e1b-401e-0002-349c-03162f000000'
    'x-ms-client-request-id': '93f74064-6f8f-11ef-b79b-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Tue, 10 Sep 2024 16:13:18 GMT'


2024-09-10 17:13:19,467 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:5dbb7e1b-401e-0002-349c-03162f000000
Time:2024-09-10T16:13:19.1597164Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:5dbb7e1b-401e-0002-349c-03162f000000
Time:2024-09-10T16:13:19.1597164Z</Message></Error>


2024-09-10 17:13:19,468 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:5dbb7e1b-401e-0002-349c-03162f000000
Time:2024-09-10T16:13:19.1597164Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:5dbb7e1b-401e-0002-349c-03162f000000
Time:2024-09-10T16:13:19.1597164Z</Message></Error>


2024-09-10 18:53:18,844 - INFO - Starting extraction process...


2024-09-10 18:53:18,849 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '900375fc-6f9d-11ef-877c-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 18:53:20,952 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '692809a4-c01e-006e-14aa-03fdb8000000'
    'x-ms-client-request-id': '900375fc-6f9d-11ef-877c-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 17:53:21 GMT'


2024-09-10 18:53:20,959 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9145cb2c-6f9d-11ef-93f1-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 18:53:21,718 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 10 Sep 2024 17:46:09 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD1C07450CBB8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '692809df-c01e-006e-47aa-03fdb8000000'
    'x-ms-client-request-id': '9145cb2c-6f9d-11ef-93f1-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 17:53:21 GMT'


2024-09-10 18:53:21,737 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset\nycpayroll_2020.csv


2024-09-10 18:53:21,738 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-10 18:53:21,739 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2020.csv


2024-09-10 18:53:21,740 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '91bcf370-6f9d-11ef-9a06-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 18:53:22,174 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Tue, 10 Sep 2024 17:53:22 GMT'
    'ETag': '"0x8DCD1C1766E09AC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '69280a4b-c01e-006e-22aa-03fdb8000000'
    'x-ms-client-request-id': '91bcf370-6f9d-11ef-9a06-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 17:53:22 GMT'


2024-09-10 18:53:22,179 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '91fff375-6f9d-11ef-8afa-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 18:53:22,909 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '69280a7b-c01e-006e-4caa-03fdb8000000'
    'x-ms-client-request-id': '91fff375-6f9d-11ef-8afa-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 17:53:22 GMT'


2024-09-10 18:53:22,912 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-10 18:53:22,913 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-10 18:53:22,914 - INFO - Starting transformation process...


2024-09-10 18:53:22,915 - INFO - Starting data transformation


2024-09-10 18:53:22,917 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-10 18:53:22,919 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-10 19:34:29,008 - INFO - Starting extraction process...


2024-09-10 19:34:29,010 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '50586b44-6fa3-11ef-9af7-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:34:30,791 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9393c5a-a01e-001a-36b0-03c948000000'
    'x-ms-client-request-id': '50586b44-6fa3-11ef-9af7-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 18:34:31 GMT'


2024-09-10 19:34:30,798 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5169382b-6fa3-11ef-a2d7-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:34:31,096 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9393ced-a01e-001a-40b0-03c948000000'
    'x-ms-client-request-id': '5169382b-6fa3-11ef-a2d7-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Tue, 10 Sep 2024 18:34:31 GMT'


2024-09-10 19:34:31,098 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5197170f-6fa3-11ef-96f9-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:34:31,406 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c9393d51-a01e-001a-21b0-03c948000000'
    'x-ms-client-request-id': '5197170f-6fa3-11ef-96f9-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 18:34:31 GMT'


2024-09-10 19:34:31,416 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset\raw_payroll_data


2024-09-10 19:34:31,418 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data


2024-09-10 19:34:31,419 - INFO - Archive blob path: Dataset/archived_payroll_data/raw_payroll_data


2024-09-10 19:34:31,421 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '51c85e61-6fa3-11ef-ae00-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:34:32,640 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '3100f985-c01e-0051-50b0-03351b000000'
    'x-ms-client-request-id': '51c85e61-6fa3-11ef-ae00-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Tue, 10 Sep 2024 18:34:32 GMT'


2024-09-10 19:34:32,650 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:3100f985-c01e-0051-50b0-03351b000000
Time:2024-09-10T18:34:33.1084857Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:3100f985-c01e-0051-50b0-03351b000000
Time:2024-09-10T18:34:33.1084857Z</Message></Error>


2024-09-10 19:34:32,652 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:3100f985-c01e-0051-50b0-03351b000000
Time:2024-09-10T18:34:33.1084857Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:3100f985-c01e-0051-50b0-03351b000000
Time:2024-09-10T18:34:33.1084857Z</Message></Error>


2024-09-10 19:34:32,654 - ERROR - ETL pipeline failed: One of the request inputs is not valid.
RequestId:3100f985-c01e-0051-50b0-03351b000000
Time:2024-09-10T18:34:33.1084857Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:3100f985-c01e-0051-50b0-03351b000000
Time:2024-09-10T18:34:33.1084857Z</Message></Error>


2024-09-10 19:38:59,344 - INFO - Starting extraction process...


2024-09-10 19:38:59,348 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f17aab80-6fa3-11ef-8440-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:39:08,498 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9b6e352b-001e-004e-74b0-03861f000000'
    'x-ms-client-request-id': 'f17aab80-6fa3-11ef-8440-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 18:39:08 GMT'


2024-09-10 19:39:08,507 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f6f03e0e-6fa3-11ef-9115-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:39:33,585 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 10 Sep 2024 18:36:43 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD1C784CEDEFC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9b6e360a-001e-004e-38b0-03861f000000'
    'x-ms-client-request-id': 'f6f03e0e-6fa3-11ef-9115-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 18:39:09 GMT'


2024-09-10 19:39:34,537 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset\nycpayroll_2020.csv


2024-09-10 19:39:34,542 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-10 19:39:34,545 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2020.csv


2024-09-10 19:39:34,550 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '06761731-6fa4-11ef-876d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:39:35,780 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Tue, 10 Sep 2024 18:39:35 GMT'
    'ETag': '"0x8DCD1C7EB1B3584"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9b6e539a-001e-004e-0db0-03861f000000'
    'x-ms-client-request-id': '06761731-6fa4-11ef-876d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 18:39:35 GMT'


2024-09-10 19:39:35,783 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '07323e9f-6fa4-11ef-b468-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-10 19:39:36,346 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '9b6e559b-001e-004e-75b0-03861f000000'
    'x-ms-client-request-id': '07323e9f-6fa4-11ef-b468-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 18:39:36 GMT'


2024-09-10 19:39:36,348 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-10 19:39:36,348 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-10 19:39:36,350 - INFO - Starting transformation process...


2024-09-10 19:39:36,350 - ERROR - ETL pipeline failed: name 'input_file_path' is not defined


2024-09-11 00:46:40,135 - INFO - Starting extraction process...


2024-09-11 00:46:40,138 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ecf7b071-6fce-11ef-916a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 00:46:40,923 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '13bc9b93-f01e-0065-70db-0306d3000000'
    'x-ms-client-request-id': 'ecf7b071-6fce-11ef-916a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 23:46:40 GMT'


2024-09-11 00:46:40,928 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ed705a0c-6fce-11ef-8564-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 00:46:41,337 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Tue, 10 Sep 2024 23:45:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD1F2A197908C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '13bc9bbe-f01e-0065-19db-0306d3000000'
    'x-ms-client-request-id': 'ed705a0c-6fce-11ef-8564-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 23:46:41 GMT'


2024-09-11 00:46:41,340 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset\nycpayroll_2020.csv


2024-09-11 00:46:41,341 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-11 00:46:41,341 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2020.csv


2024-09-11 00:46:41,343 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'edaf8c6d-6fce-11ef-8a38-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 00:46:41,516 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Tue, 10 Sep 2024 23:46:42 GMT'
    'ETag': '"0x8DCD1F2D24D65C8"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '13bc9c27-f01e-0065-7ddb-0306d3000000'
    'x-ms-client-request-id': 'edaf8c6d-6fce-11ef-8a38-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 23:46:41 GMT'


2024-09-11 00:46:41,519 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'edca7de0-6fce-11ef-ab29-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 00:46:41,670 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '13bc9c50-f01e-0065-24db-0306d3000000'
    'x-ms-client-request-id': 'edca7de0-6fce-11ef-ab29-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Tue, 10 Sep 2024 23:46:41 GMT'


2024-09-11 00:46:41,672 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-11 00:46:41,673 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-11 00:46:41,673 - INFO - Starting transformation process...


2024-09-11 00:46:41,674 - INFO - Starting data transformation


2024-09-11 00:46:41,675 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-11 00:46:41,679 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-11 00:47:45,310 - INFO - Starting data transformation


2024-09-11 00:47:46,650 - INFO - dim_date data generated and saved!


2024-09-11 00:47:46,728 - INFO - Transformed data saved to All_Dataset/Cleaned_Dataset\nycpayroll_2020.csv


2024-09-11 00:48:47,116 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 00:48:47,162 - INFO - State start


2024-09-11 00:48:47,219 - INFO -   Scheduler at:     tcp://127.0.0.1:63003


2024-09-11 00:48:47,222 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 00:48:47,224 - INFO - Registering Worker plugin shuffle


2024-09-11 00:48:47,293 - INFO -         Start Nanny at: 'tcp://127.0.0.1:63006'


2024-09-11 00:48:50,017 - INFO -       Start worker at:      tcp://127.0.0.1:63011


2024-09-11 00:48:50,018 - INFO -          Listening to:      tcp://127.0.0.1:63011


2024-09-11 00:48:50,018 - INFO -           Worker name:                          0


2024-09-11 00:48:50,018 - INFO -          dashboard at:            127.0.0.1:63012


2024-09-11 00:48:50,019 - INFO - Waiting to connect to:      tcp://127.0.0.1:63003


2024-09-11 00:48:50,020 - INFO - -------------------------------------------------


2024-09-11 00:48:50,020 - INFO -               Threads:                          4


2024-09-11 00:48:50,020 - INFO -                Memory:                  19.84 GiB


2024-09-11 00:48:50,020 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-cogck5x_


2024-09-11 00:48:50,022 - INFO - -------------------------------------------------


2024-09-11 00:48:50,028 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:63011', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 00:48:50,031 - INFO - Starting worker compute stream, tcp://127.0.0.1:63011


2024-09-11 00:48:50,031 - INFO - Starting established connection to tcp://127.0.0.1:63013


2024-09-11 00:48:50,031 - INFO - Starting Worker plugin shuffle


2024-09-11 00:48:50,032 - INFO -         Registered to:      tcp://127.0.0.1:63003


2024-09-11 00:48:50,032 - INFO - -------------------------------------------------


2024-09-11 00:48:50,035 - INFO - Starting established connection to tcp://127.0.0.1:63003


2024-09-11 00:48:50,069 - INFO - Receive client connection: Client-3799d9f4-6fcf-11ef-8bb8-f4a4751e46e5


2024-09-11 00:48:50,071 - INFO - Starting established connection to tcp://127.0.0.1:63014


2024-09-11 00:48:50,074 - INFO - Dask client initialized with 1 worker.


2024-09-11 00:48:50,095 - INFO - Connected to Snowflake successfully.


2024-09-11 00:48:50,095 - ERROR - Error loading data into Snowflake: [Errno 13] Permission denied: 'All_Dataset/Cleaned_Dataset'


2024-09-11 00:48:50,128 - INFO - Retire worker addresses (0,)


2024-09-11 00:48:50,129 - INFO - Closing Nanny at 'tcp://127.0.0.1:63006'. Reason: nanny-close


2024-09-11 00:48:50,130 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 00:48:50,130 - INFO - Stopping worker at tcp://127.0.0.1:63011. Reason: nanny-close


2024-09-11 00:48:50,132 - INFO - Removing Worker plugin shuffle


2024-09-11 00:48:50,134 - INFO - Connection to tcp://127.0.0.1:63003 has been closed.


g.


2024-09-11 00:48:50,135 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:63011', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726012130.1353939')


2024-09-11 00:48:50,137 - INFO - Lost all workers


2024-09-11 00:48:50,404 - INFO - Closing scheduler. Reason: unknown


2024-09-11 00:48:50,405 - INFO - Scheduler closing all comms


2024-09-11 08:20:54,499 - INFO - Starting load process...


2024-09-11 08:20:54,512 - ERROR - ETL pipeline failed: name 'd' is not defined


2024-09-11 08:23:11,519 - INFO - Starting load process...


2024-09-11 08:23:11,519 - ERROR - ETL pipeline failed: name 'latest_file' is not defined


2024-09-11 08:24:23,798 - INFO - Starting load process...


2024-09-11 08:24:25,577 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 08:24:25,638 - INFO - State start


2024-09-11 08:24:25,695 - INFO -   Scheduler at:     tcp://127.0.0.1:64496


2024-09-11 08:24:25,695 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 08:24:25,696 - INFO - Registering Worker plugin shuffle


2024-09-11 08:24:25,760 - INFO -         Start Nanny at: 'tcp://127.0.0.1:64499'


2024-09-11 08:24:30,418 - INFO -       Start worker at:      tcp://127.0.0.1:64506


2024-09-11 08:24:30,419 - INFO -          Listening to:      tcp://127.0.0.1:64506


2024-09-11 08:24:30,419 - INFO -           Worker name:                          0


2024-09-11 08:24:30,419 - INFO -          dashboard at:            127.0.0.1:64507


2024-09-11 08:24:30,420 - INFO - Waiting to connect to:      tcp://127.0.0.1:64496


2024-09-11 08:24:30,420 - INFO - -------------------------------------------------


2024-09-11 08:24:30,420 - INFO -               Threads:                          4


2024-09-11 08:24:30,421 - INFO -                Memory:                  19.84 GiB


2024-09-11 08:24:30,421 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-2sftif9o


2024-09-11 08:24:30,421 - INFO - -------------------------------------------------


2024-09-11 08:24:30,427 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:64506', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 08:24:30,432 - INFO - Starting worker compute stream, tcp://127.0.0.1:64506


2024-09-11 08:24:30,432 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:64508


2024-09-11 08:24:30,438 - INFO -         Registered to:      tcp://127.0.0.1:64496


2024-09-11 08:24:30,439 - INFO - -------------------------------------------------


2024-09-11 08:24:30,440 - INFO - Starting established connection to tcp://127.0.0.1:64496


2024-09-11 08:24:30,464 - INFO - Receive client connection: Client-de95ee9c-700e-11ef-8410-f4a4751e46e5


2024-09-11 08:24:30,465 - INFO - Starting established connection to tcp://127.0.0.1:64509


2024-09-11 08:24:30,466 - INFO - Dask client initialized with 1 worker.


2024-09-11 08:24:30,496 - INFO - Connected to Snowflake successfully.


2024-09-11 08:24:30,496 - ERROR - Error loading data to Snowflake: name 'file_name' is not defined


2024-09-11 08:24:30,496 - ERROR - ETL pipeline failed: name 'file_name' is not defined


2024-09-11 08:24:30,501 - INFO - Retire worker addresses (0,)


2024-09-11 08:24:30,504 - INFO - Closing Nanny at 'tcp://127.0.0.1:64499'. Reason: nanny-close


2024-09-11 08:24:30,505 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 08:24:30,508 - INFO - Stopping worker at tcp://127.0.0.1:64506. Reason: nanny-close


2024-09-11 08:24:30,509 - INFO - Removing Worker plugin shuffle


2024-09-11 08:24:30,511 - INFO - Received 'close-stream' from tcp://127.0.0.1:64508; closing.


2024-09-11 08:24:30,511 - INFO - Connection to tcp://127.0.0.1:64496 has been closed.


2024-09-11 08:24:30,513 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:64506', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726039470.5133498')


2024-09-11 08:24:30,513 - INFO - Lost all workers


2024-09-11 08:24:30,913 - INFO - Closing scheduler. Reason: unknown


2024-09-11 08:24:30,915 - INFO - Scheduler closing all comms


2024-09-11 08:25:56,521 - INFO - Starting load process...


2024-09-11 08:25:57,672 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 08:25:57,715 - INFO - State start


2024-09-11 08:25:57,762 - INFO -   Scheduler at:     tcp://127.0.0.1:64529


2024-09-11 08:25:57,765 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 08:25:57,767 - INFO - Registering Worker plugin shuffle


2024-09-11 08:25:57,837 - INFO -         Start Nanny at: 'tcp://127.0.0.1:64532'


2024-09-11 08:26:01,987 - INFO -       Start worker at:      tcp://127.0.0.1:64538


2024-09-11 08:26:01,988 - INFO -          Listening to:      tcp://127.0.0.1:64538


2024-09-11 08:26:01,989 - INFO -           Worker name:                          0


2024-09-11 08:26:01,989 - INFO -          dashboard at:            127.0.0.1:64539


2024-09-11 08:26:01,989 - INFO - Waiting to connect to:      tcp://127.0.0.1:64529


2024-09-11 08:26:01,991 - INFO - -------------------------------------------------


2024-09-11 08:26:01,991 - INFO -               Threads:                          4


2024-09-11 08:26:01,992 - INFO -                Memory:                  19.84 GiB


2024-09-11 08:26:01,992 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-sy1c8dgc


2024-09-11 08:26:01,992 - INFO - -------------------------------------------------


2024-09-11 08:26:02,003 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:64538', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 08:26:02,005 - INFO - Starting worker compute stream, tcp://127.0.0.1:64538


2024-09-11 08:26:02,006 - INFO - Starting Worker plugin shuffle


2024-09-11 08:26:02,006 - INFO - Starting established connection to tcp://127.0.0.1:64540


2024-09-11 08:26:02,008 - INFO -         Registered to:      tcp://127.0.0.1:64529


2024-09-11 08:26:02,008 - INFO - -------------------------------------------------


2024-09-11 08:26:02,010 - INFO - Starting established connection to tcp://127.0.0.1:64529


2024-09-11 08:26:02,038 - INFO - Receive client connection: Client-15da655b-700f-11ef-9178-f4a4751e46e5


2024-09-11 08:26:02,039 - INFO - Starting established connection to tcp://127.0.0.1:64541


2024-09-11 08:26:02,040 - INFO - Dask client initialized with 1 worker.


2024-09-11 08:26:02,059 - INFO - Connected to Snowflake successfully.


2024-09-11 08:26:02,060 - ERROR - Error loading data to Snowflake: name 'dd' is not defined


2024-09-11 08:26:02,060 - ERROR - ETL pipeline failed: name 'dd' is not defined


2024-09-11 08:26:02,069 - INFO - Retire worker addresses (0,)


2024-09-11 08:26:02,071 - INFO - Closing Nanny at 'tcp://127.0.0.1:64532'. Reason: nanny-close


2024-09-11 08:26:02,071 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 08:26:02,073 - INFO - Stopping worker at tcp://127.0.0.1:64538. Reason: nanny-close


2024-09-11 08:26:02,073 - INFO - Removing Worker plugin shuffle


2024-09-11 08:26:02,076 - INFO - Received 'close-stream' from tcp://127.0.0.1:64540; closing.


2024-09-11 08:26:02,076 - INFO - Connection to tcp://127.0.0.1:64529 has been closed.


2024-09-11 08:26:02,077 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:64538', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726039562.0777354')


2024-09-11 08:26:02,078 - INFO - Lost all workers


2024-09-11 08:26:02,626 - INFO - Closing scheduler. Reason: unknown


2024-09-11 08:26:02,629 - INFO - Scheduler closing all comms


2024-09-11 08:26:59,013 - INFO - Starting load process...


2024-09-11 08:26:59,965 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 08:27:00,034 - INFO - State start


2024-09-11 08:27:00,104 - INFO -   Scheduler at:     tcp://127.0.0.1:64558


2024-09-11 08:27:00,104 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 08:27:00,105 - INFO - Registering Worker plugin shuffle


2024-09-11 08:27:00,174 - INFO -         Start Nanny at: 'tcp://127.0.0.1:64561'


2024-09-11 08:27:03,613 - INFO -       Start worker at:      tcp://127.0.0.1:64567


2024-09-11 08:27:03,614 - INFO -          Listening to:      tcp://127.0.0.1:64567


2024-09-11 08:27:03,614 - INFO -           Worker name:                          0


2024-09-11 08:27:03,614 - INFO -          dashboard at:            127.0.0.1:64568


2024-09-11 08:27:03,614 - INFO - Waiting to connect to:      tcp://127.0.0.1:64558


2024-09-11 08:27:03,616 - INFO - -------------------------------------------------


2024-09-11 08:27:03,616 - INFO -               Threads:                          4


2024-09-11 08:27:03,617 - INFO -                Memory:                  19.84 GiB


2024-09-11 08:27:03,617 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-4ngno5pz


2024-09-11 08:27:03,617 - INFO - -------------------------------------------------


2024-09-11 08:27:03,628 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:64567', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 08:27:03,631 - INFO - Starting worker compute stream, tcp://127.0.0.1:64567


2024-09-11 08:27:03,632 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:64569


2024-09-11 08:27:03,633 - INFO -         Registered to:      tcp://127.0.0.1:64558


2024-09-11 08:27:03,633 - INFO - -------------------------------------------------


2024-09-11 08:27:03,635 - INFO - Starting established connection to tcp://127.0.0.1:64558


2024-09-11 08:27:03,690 - INFO - Receive client connection: Client-3b19dc01-700f-11ef-a36c-f4a4751e46e5


2024-09-11 08:27:03,691 - INFO - Starting established connection to tcp://127.0.0.1:64570


2024-09-11 08:27:03,694 - INFO - Dask client initialized with 1 worker.


2024-09-11 08:27:03,718 - INFO - Connected to Snowflake successfully.


2024-09-11 08:27:03,719 - ERROR - Error loading data to Snowflake: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Cleaned_Dataset'


2024-09-11 08:27:03,721 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Cleaned_Dataset'


2024-09-11 08:27:03,874 - INFO - Retire worker addresses (0,)


2024-09-11 08:27:03,876 - INFO - Closing Nanny at 'tcp://127.0.0.1:64561'. Reason: nanny-close


2024-09-11 08:27:03,877 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 08:27:03,879 - INFO - Stopping worker at tcp://127.0.0.1:64567. Reason: nanny-close


2024-09-11 08:27:03,880 - INFO - Removing Worker plugin shuffle


2024-09-11 08:27:03,882 - INFO - Received 'close-stream' from tcp://127.0.0.1:64569; closing.


2024-09-11 08:27:03,883 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:64567', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726039623.883553')


2024-09-11 08:27:03,885 - INFO - Lost all workers


2024-09-11 08:27:04,471 - INFO - Closing scheduler. Reason: unknown


2024-09-11 08:27:04,471 - INFO - Scheduler closing all comms


2024-09-11 09:14:57,960 - INFO - Starting load process...


2024-09-11 09:14:58,987 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 09:14:59,078 - INFO - State start


2024-09-11 09:14:59,224 - INFO -   Scheduler at:     tcp://127.0.0.1:53883


2024-09-11 09:14:59,225 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 09:14:59,226 - INFO - Registering Worker plugin shuffle


2024-09-11 09:14:59,332 - INFO -         Start Nanny at: 'tcp://127.0.0.1:53886'


2024-09-11 09:15:04,960 - INFO -       Start worker at:      tcp://127.0.0.1:53892


2024-09-11 09:15:04,962 - INFO -          Listening to:      tcp://127.0.0.1:53892


2024-09-11 09:15:04,963 - INFO -           Worker name:                          0


2024-09-11 09:15:04,964 - INFO -          dashboard at:            127.0.0.1:53893


2024-09-11 09:15:04,964 - INFO - Waiting to connect to:      tcp://127.0.0.1:53883


2024-09-11 09:15:04,965 - INFO - -------------------------------------------------


2024-09-11 09:15:04,966 - INFO -               Threads:                          4


2024-09-11 09:15:04,969 - INFO -                Memory:                  19.84 GiB


2024-09-11 09:15:04,970 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-v5uej8ym


2024-09-11 09:15:04,971 - INFO - -------------------------------------------------


2024-09-11 09:15:04,998 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:53892', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 09:15:05,004 - INFO - Starting worker compute stream, tcp://127.0.0.1:53892


2024-09-11 09:15:05,006 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:53894


2024-09-11 09:15:05,014 - INFO -         Registered to:      tcp://127.0.0.1:53883


2024-09-11 09:15:05,015 - INFO - -------------------------------------------------


2024-09-11 09:15:05,026 - INFO - Starting established connection to tcp://127.0.0.1:53883


2024-09-11 09:15:05,060 - INFO - Receive client connection: Client-ef166c6c-7015-11ef-8bbc-f4a4751e46e5


2024-09-11 09:15:05,061 - INFO - Starting established connection to tcp://127.0.0.1:53895


2024-09-11 09:15:05,064 - INFO - Dask client initialized with 1 worker.


2024-09-11 09:15:05,115 - INFO - Connected to Snowflake successfully.


2024-09-11 09:15:05,118 - ERROR - Error loading data to Snowflake: name 'transform_dir' is not defined


2024-09-11 09:15:05,119 - ERROR - ETL pipeline failed: name 'transform_dir' is not defined


2024-09-11 09:15:05,130 - INFO - Retire worker addresses (0,)


2024-09-11 09:15:05,133 - INFO - Closing Nanny at 'tcp://127.0.0.1:53886'. Reason: nanny-close


2024-09-11 09:15:05,136 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 09:15:05,140 - INFO - Stopping worker at tcp://127.0.0.1:53892. Reason: nanny-close


2024-09-11 09:15:05,143 - INFO - Removing Worker plugin shuffle


2024-09-11 09:15:05,146 - INFO - Received 'close-stream' from tcp://127.0.0.1:53894; closing.


2024-09-11 09:15:05,146 - INFO - Connection to tcp://127.0.0.1:53883 has been closed.


2024-09-11 09:15:05,154 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:53892', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726042505.1551354')


2024-09-11 09:15:05,156 - INFO - Lost all workers


2024-09-11 09:15:05,808 - INFO - Closing scheduler. Reason: unknown


2024-09-11 09:15:05,815 - INFO - Scheduler closing all comms


2024-09-11 09:19:28,595 - INFO - Starting load process...


2024-09-11 09:19:29,721 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 09:19:29,883 - INFO - State start


2024-09-11 09:19:29,959 - INFO -   Scheduler at:     tcp://127.0.0.1:53963


2024-09-11 09:19:29,960 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 09:19:29,961 - INFO - Registering Worker plugin shuffle


2024-09-11 09:19:30,060 - INFO -         Start Nanny at: 'tcp://127.0.0.1:53966'


2024-09-11 09:19:35,964 - INFO -       Start worker at:      tcp://127.0.0.1:53972


2024-09-11 09:19:35,965 - INFO -          Listening to:      tcp://127.0.0.1:53972


2024-09-11 09:19:35,966 - INFO -           Worker name:                          0


2024-09-11 09:19:35,969 - INFO -          dashboard at:            127.0.0.1:53973


2024-09-11 09:19:35,973 - INFO - Waiting to connect to:      tcp://127.0.0.1:53963


2024-09-11 09:19:35,976 - INFO - -------------------------------------------------


2024-09-11 09:19:35,980 - INFO -               Threads:                          4


2024-09-11 09:19:35,981 - INFO -                Memory:                  19.84 GiB


2024-09-11 09:19:35,983 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-g44poy4i


2024-09-11 09:19:35,988 - INFO - -------------------------------------------------


2024-09-11 09:19:36,063 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:53972', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 09:19:36,076 - INFO - Starting worker compute stream, tcp://127.0.0.1:53972


2024-09-11 09:19:36,078 - INFO - Starting Worker plugin shuffle


2024-09-11 09:19:36,078 - INFO - Starting established connection to tcp://127.0.0.1:53974


2024-09-11 09:19:36,081 - INFO -         Registered to:      tcp://127.0.0.1:53963


2024-09-11 09:19:36,083 - INFO - -------------------------------------------------


2024-09-11 09:19:36,100 - INFO - Starting established connection to tcp://127.0.0.1:53963


2024-09-11 09:19:36,126 - INFO - Receive client connection: Client-90679fa7-7016-11ef-ac94-f4a4751e46e5


2024-09-11 09:19:36,128 - INFO - Starting established connection to tcp://127.0.0.1:53975


2024-09-11 09:19:36,131 - INFO - Dask client initialized with 1 worker.


2024-09-11 09:19:36,205 - INFO - Connected to Snowflake successfully.


2024-09-11 09:19:36,211 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\nycpayroll_2020.csv' loaded successfully.


2024-09-11 09:19:36,445 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-11 09:19:36,656 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-11 09:19:36,657 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-11 09:19:46,371 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:47,292 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:48,023 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:48,025 - INFO - Table "Dim_Employee" created or already exists.


2024-09-11 09:19:48,579 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:48,581 - INFO - Truncated "Dim_Employee" successfully.


2024-09-11 09:19:49,749 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:49,750 - INFO - Table "Dim_Agency" created or already exists.


2024-09-11 09:19:50,273 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:50,276 - INFO - Truncated "Dim_Agency" successfully.


2024-09-11 09:19:51,009 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:51,010 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-11 09:19:51,671 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:51,672 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-11 09:19:52,406 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:52,406 - INFO - Table "Dim_Date" created or already exists.


2024-09-11 09:19:52,914 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:52,914 - INFO - Truncated "Dim_Date" successfully.


2024-09-11 09:19:53,549 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:53,556 - INFO - Table "FactPayroll" created or already exists.


2024-09-11 09:19:54,861 - INFO - Number of results in first chunk: 1


2024-09-11 09:19:54,862 - INFO - Truncated "FactPayroll" successfully.


2024-09-11 09:19:56,022 - INFO - Number of results in first chunk: 6


2024-09-11 09:19:56,541 - INFO - Number of results in first chunk: 6


2024-09-11 09:19:58,748 - INFO - Number of results in first chunk: 6


2024-09-11 09:19:59,206 - INFO - Number of results in first chunk: 0


2024-09-11 09:19:59,877 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:00,392 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:04,019 - INFO - Number of results in first chunk: 34


2024-09-11 09:20:04,519 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:05,405 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:05,923 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:06,591 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:09,207 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:11,653 - INFO - Number of results in first chunk: 6


2024-09-11 09:20:11,655 - INFO - Dim_Date data loaded successfully.


2024-09-11 09:20:12,369 - INFO - Number of results in first chunk: 8


2024-09-11 09:20:12,894 - INFO - Number of results in first chunk: 8


2024-09-11 09:20:13,394 - INFO - Number of results in first chunk: 6


2024-09-11 09:20:13,905 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:14,317 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:14,728 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:17,591 - INFO - Number of results in first chunk: 34


2024-09-11 09:20:18,103 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:18,711 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:19,229 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:19,947 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:20,700 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:21,940 - INFO - Number of results in first chunk: 6


2024-09-11 09:20:21,942 - INFO - Dim_Employee data loaded successfully.


2024-09-11 09:20:22,422 - INFO - Number of results in first chunk: 2


2024-09-11 09:20:22,939 - INFO - Number of results in first chunk: 2


2024-09-11 09:20:23,431 - INFO - Number of results in first chunk: 6


2024-09-11 09:20:24,503 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:26,400 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:26,881 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:29,009 - INFO - Number of results in first chunk: 34


2024-09-11 09:20:29,499 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:30,035 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:30,493 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:31,311 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:32,850 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:34,389 - INFO - Number of results in first chunk: 6


2024-09-11 09:20:34,395 - INFO - Dim_Agency data loaded successfully.


2024-09-11 09:20:35,102 - INFO - Number of results in first chunk: 2


2024-09-11 09:20:36,682 - INFO - Number of results in first chunk: 2


2024-09-11 09:20:37,106 - INFO - Number of results in first chunk: 6


2024-09-11 09:20:38,801 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:39,198 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:39,708 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:41,041 - INFO - Number of results in first chunk: 34


2024-09-11 09:20:41,553 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:42,014 - INFO - Number of results in first chunk: 0


2024-09-11 09:20:42,486 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:44,187 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:45,751 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:48,418 - INFO - Number of results in first chunk: 6


2024-09-11 09:20:48,420 - INFO - Dim_PayBasis data loaded successfully.


2024-09-11 09:20:48,924 - INFO - Number of results in first chunk: 1


2024-09-11 09:20:48,925 - ERROR - Error loading data to Snowflake: 'DataFrame' object has no attribute 'compute'


2024-09-11 09:20:48,925 - ERROR - ETL pipeline failed: 'DataFrame' object has no attribute 'compute'


2024-09-11 09:20:48,936 - INFO - closed


2024-09-11 09:20:48,936 - INFO - No async queries seem to be running, deleting session


2024-09-11 09:20:49,446 - INFO - Retire worker addresses (0,)


2024-09-11 09:20:49,622 - INFO - Closing Nanny at 'tcp://127.0.0.1:53966'. Reason: nanny-close


2024-09-11 09:20:49,623 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 09:20:49,637 - INFO - Stopping worker at tcp://127.0.0.1:53972. Reason: nanny-close


2024-09-11 09:20:49,639 - INFO - Removing Worker plugin shuffle


2024-09-11 09:20:49,642 - INFO - Connection to tcp://127.0.0.1:53963 has been closed.


2024-09-11 09:20:49,680 - INFO - Received 'close-stream' from tcp://127.0.0.1:53974; closing.


2024-09-11 09:20:49,688 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:53972', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726042849.6885617')


2024-09-11 09:20:49,690 - INFO - Lost all workers


2024-09-11 09:20:50,195 - INFO - Closing scheduler. Reason: unknown


2024-09-11 09:20:50,199 - INFO - Scheduler closing all comms


2024-09-11 09:27:47,322 - INFO - Starting load process...


2024-09-11 09:27:48,440 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 09:27:48,532 - INFO - State start


2024-09-11 09:27:48,647 - INFO -   Scheduler at:     tcp://127.0.0.1:54058


2024-09-11 09:27:48,648 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 09:27:48,649 - INFO - Registering Worker plugin shuffle


2024-09-11 09:27:48,736 - INFO -         Start Nanny at: 'tcp://127.0.0.1:54061'


2024-09-11 09:27:54,037 - INFO -       Start worker at:      tcp://127.0.0.1:54067


2024-09-11 09:27:54,037 - INFO -          Listening to:      tcp://127.0.0.1:54067


2024-09-11 09:27:54,037 - INFO -           Worker name:                          0


2024-09-11 09:27:54,039 - INFO -          dashboard at:            127.0.0.1:54068


2024-09-11 09:27:54,039 - INFO - Waiting to connect to:      tcp://127.0.0.1:54058


2024-09-11 09:27:54,040 - INFO - -------------------------------------------------


2024-09-11 09:27:54,040 - INFO -               Threads:                          4


2024-09-11 09:27:54,041 - INFO -                Memory:                  19.84 GiB


2024-09-11 09:27:54,042 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-ik0d3pf_


2024-09-11 09:27:54,043 - INFO - -------------------------------------------------


2024-09-11 09:27:54,051 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:54067', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 09:27:54,054 - INFO - Starting worker compute stream, tcp://127.0.0.1:54067


2024-09-11 09:27:54,055 - INFO - Starting Worker plugin shuffle


2024-09-11 09:27:54,055 - INFO - Starting established connection to tcp://127.0.0.1:54069


2024-09-11 09:27:54,057 - INFO -         Registered to:      tcp://127.0.0.1:54058


2024-09-11 09:27:54,057 - INFO - -------------------------------------------------


2024-09-11 09:27:54,065 - INFO - Starting established connection to tcp://127.0.0.1:54058


2024-09-11 09:27:54,191 - INFO - Receive client connection: Client-b9a9961b-7017-11ef-97c0-f4a4751e46e5


2024-09-11 09:27:54,192 - INFO - Starting established connection to tcp://127.0.0.1:54070


2024-09-11 09:27:54,194 - INFO - Dask client initialized with 1 worker.


2024-09-11 09:27:54,229 - INFO - Connected to Snowflake successfully.


2024-09-11 09:27:54,231 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\nycpayroll_2020.csv' loaded successfully.


2024-09-11 09:27:54,301 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-11 09:27:54,303 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-11 09:27:54,303 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-11 09:27:59,103 - INFO - Number of results in first chunk: 1


2024-09-11 09:27:59,715 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:00,187 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:00,217 - INFO - Table "Dim_Employee" created or already exists.


2024-09-11 09:28:01,251 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:01,251 - INFO - Truncated "Dim_Employee" successfully.


2024-09-11 09:28:01,702 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:01,705 - INFO - Table "Dim_Agency" created or already exists.


2024-09-11 09:28:02,587 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:02,589 - INFO - Truncated "Dim_Agency" successfully.


2024-09-11 09:28:03,045 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:03,047 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-11 09:28:03,615 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:03,618 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-11 09:28:04,018 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:04,020 - INFO - Table "Dim_Date" created or already exists.


2024-09-11 09:28:04,527 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:04,528 - INFO - Truncated "Dim_Date" successfully.


2024-09-11 09:28:04,944 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:04,947 - INFO - Table "FactPayroll" created or already exists.


2024-09-11 09:28:05,500 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:05,500 - INFO - Truncated "FactPayroll" successfully.


2024-09-11 09:28:06,071 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:06,371 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:07,082 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:07,510 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:07,912 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:08,420 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:10,611 - INFO - Number of results in first chunk: 34


2024-09-11 09:28:11,204 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:11,601 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:12,010 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:13,032 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:13,705 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:14,870 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:14,872 - INFO - Dim_Date data loaded successfully.


2024-09-11 09:28:15,284 - INFO - Number of results in first chunk: 8


2024-09-11 09:28:15,779 - INFO - Number of results in first chunk: 8


2024-09-11 09:28:16,266 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:16,615 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:17,020 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:17,437 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:18,967 - INFO - Number of results in first chunk: 34


2024-09-11 09:28:19,380 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:19,787 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:20,152 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:20,716 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:21,365 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:22,451 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:22,453 - INFO - Dim_Employee data loaded successfully.


2024-09-11 09:28:23,072 - INFO - Number of results in first chunk: 2


2024-09-11 09:28:23,472 - INFO - Number of results in first chunk: 2


2024-09-11 09:28:24,054 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:24,720 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:26,099 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:26,953 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:28,198 - INFO - Number of results in first chunk: 34


2024-09-11 09:28:28,890 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:29,211 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:29,622 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:30,292 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:30,735 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:31,716 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:31,717 - INFO - Dim_Agency data loaded successfully.


2024-09-11 09:28:32,371 - INFO - Number of results in first chunk: 2


2024-09-11 09:28:32,717 - INFO - Number of results in first chunk: 2


2024-09-11 09:28:33,100 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:33,470 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:33,871 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:34,241 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:35,912 - INFO - Number of results in first chunk: 34


2024-09-11 09:28:36,274 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:36,771 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:37,857 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:38,408 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:39,270 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:40,240 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:40,316 - INFO - Dim_PayBasis data loaded successfully.


2024-09-11 09:28:41,530 - INFO - Number of results in first chunk: 13


2024-09-11 09:28:41,907 - INFO - Number of results in first chunk: 13


2024-09-11 09:28:42,278 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:42,916 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:43,218 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:44,362 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:45,521 - INFO - Number of results in first chunk: 34


2024-09-11 09:28:46,108 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:46,716 - INFO - Number of results in first chunk: 0


2024-09-11 09:28:47,827 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:48,469 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:49,080 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:50,401 - INFO - Number of results in first chunk: 6


2024-09-11 09:28:50,404 - INFO - FactPayroll data loaded successfully.


2024-09-11 09:28:50,920 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:50,927 - INFO - All data loaded successfully.


2024-09-11 09:28:52,454 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:52,463 - INFO - Closing Snowflake connection.


2024-09-11 09:28:52,580 - INFO - Retire worker addresses (0,)


2024-09-11 09:28:52,586 - INFO - Closing Nanny at 'tcp://127.0.0.1:54061'. Reason: nanny-close


2024-09-11 09:28:52,595 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 09:28:52,670 - INFO - Stopping worker at tcp://127.0.0.1:54067. Reason: nanny-close


2024-09-11 09:28:52,679 - INFO - Removing Worker plugin shuffle


2024-09-11 09:28:52,684 - INFO - Connection to tcp://127.0.0.1:54058 has been closed.


2024-09-11 09:28:52,753 - INFO - Received 'close-stream' from tcp://127.0.0.1:54069; closing.


2024-09-11 09:28:52,764 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:54067', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726043332.7643435')


2024-09-11 09:28:52,767 - INFO - Lost all workers


2024-09-11 09:28:53,484 - INFO - Closing scheduler. Reason: unknown


2024-09-11 09:28:53,487 - INFO - Scheduler closing all comms


2024-09-11 09:28:53,516 - INFO - Dask client shutdown complete.


2024-09-11 09:28:53,529 - INFO - Executing stored procedure in Snowflake...


2024-09-11 09:28:53,534 - INFO - Connected to Snowflake successfully.


2024-09-11 09:28:53,536 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-11 09:28:53,548 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-11 09:28:53,550 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-11 09:28:56,973 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:57,467 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:59,248 - INFO - Number of results in first chunk: 1


2024-09-11 09:28:59,249 - ERROR - ETL pipeline failed: (snowflake.connector.errors.ProgrammingError) 090232 (25000): 01b6f49c-0000-729a-0022-af03000500fe: Stored procedure execution error: Scoped transaction started in stored procedure is incomplete and it was rolled back.
[SQL: CALL "STG".PAYROLL_AGGREGATES();]
(Background on this error at: https://sqlalche.me/e/20/f405)


2024-09-11 09:28:59,298 - INFO - closed


2024-09-11 09:28:59,298 - INFO - No async queries seem to be running, deleting session


2024-09-11 09:28:59,598 - INFO - closed


2024-09-11 09:28:59,599 - INFO - No async queries seem to be running, deleting session


2024-09-11 10:00:12,411 - INFO - Executing stored procedure in Snowflake...


2024-09-11 10:00:12,434 - INFO - Connected to Snowflake successfully.


2024-09-11 10:00:12,436 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-11 10:00:12,437 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-11 10:00:12,439 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-11 10:00:26,679 - INFO - Number of results in first chunk: 1


2024-09-11 10:00:27,497 - INFO - Number of results in first chunk: 1


2024-09-11 10:00:32,309 - INFO - Number of results in first chunk: 1


2024-09-11 10:00:32,311 - INFO - Stored procedure executed successfully.


2024-09-11 10:00:32,826 - INFO - Number of results in first chunk: 1


2024-09-11 10:00:32,827 - INFO - ETL pipeline completed successfully.


2024-09-11 10:00:32,828 - INFO - closed


2024-09-11 10:00:32,830 - INFO - No async queries seem to be running, deleting session


2024-09-11 10:14:42,282 - INFO - Starting extraction process...


2024-09-11 10:14:42,296 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '47845392-701e-11ef-afc5-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:14:43,618 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '550ffe03-801e-0050-562b-046ac7000000'
    'x-ms-client-request-id': '47845392-701e-11ef-afc5-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 11 Sep 2024 09:14:44 GMT'


2024-09-11 10:14:43,629 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '484f98cf-701e-11ef-b517-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:14:43,907 - INFO - Response status: 416
Response headers:
    'Content-Length': '249'
    'Content-Type': 'application/xml'
    'Content-Range': 'REDACTED'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '550ffe56-801e-0050-1e2b-046ac7000000'
    'x-ms-client-request-id': '484f98cf-701e-11ef-b517-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidRange'
    'Date': 'Wed, 11 Sep 2024 09:14:44 GMT'


2024-09-11 10:14:43,918 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '487bd775-701e-11ef-b5cb-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:14:44,142 - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Content-Type': 'application/octet-stream'
    'Last-Modified': 'Sat, 07 Sep 2024 11:24:20 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCCF2F9E079504"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '550ffeab-801e-0050-6e2b-046ac7000000'
    'x-ms-client-request-id': '487bd775-701e-11ef-b5cb-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-meta-hdi_isfolder': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 11 Sep 2024 09:14:45 GMT'


2024-09-11 10:14:44,220 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data to All_Dataset/Raw_Dataset\raw_payroll_data


2024-09-11 10:14:44,221 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data


2024-09-11 10:14:44,222 - INFO - Archive blob path: Dataset/archived_payroll_data/raw_payroll_data


2024-09-11 10:14:44,224 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/raw_payroll_data'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '48aa7a48-701e-11ef-b05a-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:14:45,564 - INFO - Response status: 400
Response headers:
    'Content-Length': '220'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '013803ef-101e-000f-7d2b-04defb000000'
    'x-ms-client-request-id': '48aa7a48-701e-11ef-b05a-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-error-code': 'InvalidInput'
    'Date': 'Wed, 11 Sep 2024 09:14:45 GMT'


2024-09-11 10:14:45,569 - ERROR - Error archiving the file Dataset/raw_payroll_data: One of the request inputs is not valid.
RequestId:013803ef-101e-000f-7d2b-04defb000000
Time:2024-09-11T09:14:46.4971107Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:013803ef-101e-000f-7d2b-04defb000000
Time:2024-09-11T09:14:46.4971107Z</Message></Error>


2024-09-11 10:14:45,572 - ERROR - Error in the extraction process: One of the request inputs is not valid.
RequestId:013803ef-101e-000f-7d2b-04defb000000
Time:2024-09-11T09:14:46.4971107Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:013803ef-101e-000f-7d2b-04defb000000
Time:2024-09-11T09:14:46.4971107Z</Message></Error>


2024-09-11 10:14:45,578 - ERROR - ETL pipeline failed: One of the request inputs is not valid.
RequestId:013803ef-101e-000f-7d2b-04defb000000
Time:2024-09-11T09:14:46.4971107Z
ErrorCode:InvalidInput
Content: <?xml version="1.0" encoding="utf-8"?><Error><Code>InvalidInput</Code><Message>One of the request inputs is not valid.
RequestId:013803ef-101e-000f-7d2b-04defb000000
Time:2024-09-11T09:14:46.4971107Z</Message></Error>


2024-09-11 10:17:21,979 - INFO - Starting extraction process...


2024-09-11 10:17:21,982 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a6b26a44-701e-11ef-a693-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:17:23,508 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c5bf7348-e01e-0069-272b-0491db000000'
    'x-ms-client-request-id': 'a6b26a44-701e-11ef-a693-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Wed, 11 Sep 2024 09:17:23 GMT'


2024-09-11 10:17:23,748 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a7c00ef3-701e-11ef-8af3-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:17:24,475 - INFO - Response status: 206
Response headers:
    'Content-Length': '17478'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Wed, 11 Sep 2024 09:15:56 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD24257C8EAFC"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c5bf7401-e01e-0069-542b-0491db000000'
    'x-ms-client-request-id': 'a7c00ef3-701e-11ef-8af3-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Wed, 11 Sep 2024 09:17:24 GMT'


2024-09-11 10:17:24,481 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2020.csv to All_Dataset/Raw_Dataset\nycpayroll_2020.csv


2024-09-11 10:17:24,482 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-11 10:17:24,484 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2020.csv


2024-09-11 10:17:24,486 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2020.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a8308abe-701e-11ef-b22d-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:17:24,755 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 11 Sep 2024 09:17:25 GMT'
    'ETag': '"0x8DCD2428D26A49C"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c5bf7463-e01e-0069-292b-0491db000000'
    'x-ms-client-request-id': 'a8308abe-701e-11ef-b22d-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Wed, 11 Sep 2024 09:17:25 GMT'


2024-09-11 10:17:24,757 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2020.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a85a087e-701e-11ef-8935-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-11 10:17:25,003 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'c5bf7484-e01e-0069-442b-0491db000000'
    'x-ms-client-request-id': 'a85a087e-701e-11ef-8935-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Wed, 11 Sep 2024 09:17:25 GMT'


2024-09-11 10:17:25,005 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2020.csv


2024-09-11 10:17:25,006 - INFO - File Dataset/raw_payroll_data/nycpayroll_2020.csv processed and archived successfully.


2024-09-11 10:17:25,007 - INFO - Starting transformation process...


2024-09-11 10:17:25,008 - INFO - Starting data transformation


2024-09-11 10:17:25,012 - ERROR - Error during data transformation: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-11 10:17:25,014 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [Errno 13] Permission denied: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Raw_Dataset'


2024-09-11 11:05:56,541 - INFO - Starting transformation process...


2024-09-11 11:05:56,542 - INFO - Starting data transformation


2024-09-11 11:05:56,543 - ERROR - Error during data transformation: Input file does not exist or is not a file: All_Dataset/Raw_Dataset


2024-09-11 11:05:56,546 - ERROR - ETL pipeline failed: Input file does not exist or is not a file: All_Dataset/Raw_Dataset


2024-09-11 12:45:21,172 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 12:45:21,173 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 12:45:21,175 - ERROR - Error processing new dataset: transform_data() got an unexpected keyword argument 'output_folder'


2024-09-11 13:10:09,515 - INFO - Starting transformation process...


2024-09-11 13:10:09,517 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 13:10:09,521 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 13:10:09,537 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 13:10:09,595 - ERROR - Error processing new dataset: transform_data() got an unexpected keyword argument 'output_folder'


2024-09-11 13:10:09,602 - ERROR - ETL pipeline failed: transform_data() got an unexpected keyword argument 'output_folder'


2024-09-11 13:10:16,047 - INFO - Starting transformation process...


2024-09-11 13:10:16,048 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 13:10:16,049 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 13:10:16,049 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 13:10:16,052 - ERROR - Error processing new dataset: transform_data() got an unexpected keyword argument 'output_folder'


2024-09-11 13:10:16,053 - ERROR - ETL pipeline failed: transform_data() got an unexpected keyword argument 'output_folder'


2024-09-11 20:45:35,207 - INFO - Starting transformation process...


2024-09-11 20:45:35,207 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 20:45:35,209 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:45:35,209 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:45:35,209 - ERROR - Error processing new dataset: name 'input_folder_path' is not defined


2024-09-11 20:45:35,211 - ERROR - ETL pipeline failed: name 'input_folder_path' is not defined


2024-09-11 20:47:11,770 - INFO - Starting transformation process...


2024-09-11 20:47:11,771 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 20:47:11,772 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:47:11,772 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:47:11,773 - ERROR - Error processing new dataset: Input folder does not exist: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:47:11,774 - ERROR - ETL pipeline failed: Input folder does not exist: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:58:25,216 - INFO - Starting transformation process...


2024-09-11 20:58:25,217 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 20:58:25,217 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:58:25,217 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:58:25,218 - ERROR - Error processing new dataset: Input file does not exist: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 20:58:25,219 - ERROR - ETL pipeline failed: Input file does not exist: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:23:16,144 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 21:23:17,692 - INFO - Starting transformation process...


2024-09-11 21:23:17,692 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 21:23:17,692 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:23:17,693 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:23:17,695 - ERROR - Error processing new dataset: Input file does not exist: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:23:17,695 - ERROR - ETL pipeline failed: Input file does not exist: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:42:59,982 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 21:43:01,922 - INFO - Starting transformation process...


2024-09-11 21:43:01,923 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 21:43:01,923 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:43:01,925 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:43:01,926 - INFO - Starting data transformation


2024-09-11 21:43:01,926 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 21:43:01,974 - INFO - Starting load process...


2024-09-11 21:43:03,583 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 21:43:03,625 - INFO - State start


2024-09-11 21:43:03,694 - INFO -   Scheduler at:     tcp://127.0.0.1:58220


2024-09-11 21:43:03,695 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 21:43:03,695 - INFO - Registering Worker plugin shuffle


2024-09-11 21:43:03,754 - INFO -         Start Nanny at: 'tcp://127.0.0.1:58223'


2024-09-11 21:43:06,051 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 21:43:07,360 - INFO -       Start worker at:      tcp://127.0.0.1:58229


2024-09-11 21:43:07,360 - INFO -          Listening to:      tcp://127.0.0.1:58229


2024-09-11 21:43:07,361 - INFO -           Worker name:                          0


2024-09-11 21:43:07,361 - INFO -          dashboard at:            127.0.0.1:58230


2024-09-11 21:43:07,362 - INFO - Waiting to connect to:      tcp://127.0.0.1:58220


2024-09-11 21:43:07,362 - INFO - -------------------------------------------------


2024-09-11 21:43:07,362 - INFO -               Threads:                          4


2024-09-11 21:43:07,363 - INFO -                Memory:                  19.84 GiB


2024-09-11 21:43:07,363 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-g9wffjlp


2024-09-11 21:43:07,364 - INFO - -------------------------------------------------


2024-09-11 21:43:07,370 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:58229', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 21:43:07,375 - INFO - Starting worker compute stream, tcp://127.0.0.1:58229


2024-09-11 21:43:07,376 - INFO - Starting Worker plugin shuffle


2024-09-11 21:43:07,376 - INFO - Starting established connection to tcp://127.0.0.1:58231


2024-09-11 21:43:07,379 - INFO -         Registered to:      tcp://127.0.0.1:58220


2024-09-11 21:43:07,380 - INFO - -------------------------------------------------


2024-09-11 21:43:07,382 - INFO - Starting established connection to tcp://127.0.0.1:58220


2024-09-11 21:43:07,428 - INFO - Receive client connection: Client-700b3566-707e-11ef-a83c-f4a4751e46e5


2024-09-11 21:43:07,429 - INFO - Starting established connection to tcp://127.0.0.1:58232


2024-09-11 21:43:07,431 - INFO - Dask client initialized with 1 worker.


2024-09-11 21:43:07,460 - INFO - Connected to Snowflake successfully.


2024-09-11 21:43:07,462 - ERROR - Error loading data to Snowflake: No CSV files found in All_Dataset/Cleaned_Dataset


2024-09-11 21:43:07,463 - ERROR - ETL pipeline failed: No CSV files found in All_Dataset/Cleaned_Dataset


2024-09-11 21:43:07,480 - INFO - Retire worker addresses (0,)


2024-09-11 21:43:07,483 - INFO - Closing Nanny at 'tcp://127.0.0.1:58223'. Reason: nanny-close


2024-09-11 21:43:07,483 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 21:43:07,485 - INFO - Stopping worker at tcp://127.0.0.1:58229. Reason: nanny-close


2024-09-11 21:43:07,485 - INFO - Removing Worker plugin shuffle


2024-09-11 21:43:07,487 - INFO - Connection to tcp://127.0.0.1:58220 has been closed.


2024-09-11 21:43:07,487 - INFO - Received 'close-stream' from tcp://127.0.0.1:58231; closing.


2024-09-11 21:43:07,496 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:58229', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726087387.4965162')


2024-09-11 21:43:07,498 - INFO - Lost all workers


2024-09-11 21:43:07,925 - INFO - Closing scheduler. Reason: unknown


2024-09-11 21:43:07,926 - INFO - Scheduler closing all comms


2024-09-11 22:53:09,253 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 22:53:10,521 - INFO - Starting transformation process...


2024-09-11 22:53:10,522 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 22:53:10,523 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 22:53:10,523 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 22:53:10,525 - INFO - Starting data transformation


2024-09-11 22:53:10,525 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 22:53:11,915 - INFO - Transformed data saved to C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Cleaned_Dataset\cleaned_dataset.csv


2024-09-11 22:53:11,917 - ERROR - Error during data transformation: 'Series' object has no attribute 'compute'


2024-09-11 22:53:11,917 - ERROR - Error processing new dataset: 'Series' object has no attribute 'compute'


2024-09-11 22:53:11,918 - ERROR - ETL pipeline failed: 'Series' object has no attribute 'compute'


2024-09-11 22:57:00,495 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 22:57:02,409 - INFO - Starting transformation process...


2024-09-11 22:57:02,411 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 22:57:02,413 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 22:57:02,413 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 22:57:02,416 - INFO - Starting data transformation


2024-09-11 22:57:02,418 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 22:57:03,393 - INFO - Transformed data saved to C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Cleaned_Dataset\cleaned_dataset.csv


2024-09-11 22:57:03,397 - ERROR - Error during data transformation: name 'dim_date_output_path' is not defined


2024-09-11 22:57:03,398 - ERROR - Error processing new dataset: name 'dim_date_output_path' is not defined


2024-09-11 22:57:03,398 - ERROR - ETL pipeline failed: name 'dim_date_output_path' is not defined


2024-09-11 23:02:11,857 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:02:15,957 - INFO - Starting transformation process...


2024-09-11 23:02:15,958 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 23:02:15,959 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:02:15,967 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:02:15,976 - INFO - Starting data transformation


2024-09-11 23:02:15,978 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:02:17,147 - INFO - Transformed data saved to C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Cleaned_Dataset\cleaned_dataset.csv


2024-09-11 23:02:17,153 - INFO - dim_date data generated and saved!


2024-09-11 23:02:17,153 - INFO - Starting load process...


2024-09-11 23:02:18,525 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 23:02:18,613 - INFO - State start


2024-09-11 23:02:18,703 - INFO -   Scheduler at:     tcp://127.0.0.1:52380


2024-09-11 23:02:18,704 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 23:02:18,705 - INFO - Registering Worker plugin shuffle


2024-09-11 23:02:18,801 - INFO -         Start Nanny at: 'tcp://127.0.0.1:52383'


2024-09-11 23:02:22,891 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:02:25,082 - INFO -       Start worker at:      tcp://127.0.0.1:52390


2024-09-11 23:02:25,098 - INFO -          Listening to:      tcp://127.0.0.1:52390


2024-09-11 23:02:25,099 - INFO -           Worker name:                          0


2024-09-11 23:02:25,103 - INFO -          dashboard at:            127.0.0.1:52391


2024-09-11 23:02:25,107 - INFO - Waiting to connect to:      tcp://127.0.0.1:52380


2024-09-11 23:02:25,115 - INFO - -------------------------------------------------


2024-09-11 23:02:25,116 - INFO -               Threads:                          4


2024-09-11 23:02:25,116 - INFO -                Memory:                  19.84 GiB


2024-09-11 23:02:25,118 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-2a8ior3c


2024-09-11 23:02:25,119 - INFO - -------------------------------------------------


2024-09-11 23:02:25,132 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:52390', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 23:02:25,160 - INFO - Starting worker compute stream, tcp://127.0.0.1:52390


2024-09-11 23:02:25,162 - INFO - Starting Worker plugin shuffle


2024-09-11 23:02:25,162 - INFO - Starting established connection to tcp://127.0.0.1:52392


2024-09-11 23:02:25,190 - INFO -         Registered to:      tcp://127.0.0.1:52380


2024-09-11 23:02:25,215 - INFO - -------------------------------------------------


2024-09-11 23:02:25,336 - INFO - Starting established connection to tcp://127.0.0.1:52380


2024-09-11 23:02:25,368 - INFO - Receive client connection: Client-825a017b-7089-11ef-b630-f4a4751e46e5


2024-09-11 23:02:25,369 - INFO - Starting established connection to tcp://127.0.0.1:52393


2024-09-11 23:02:25,372 - INFO - Dask client initialized with 1 worker.


2024-09-11 23:02:25,413 - INFO - Connected to Snowflake successfully.


2024-09-11 23:02:25,415 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\cleaned_dataset.csv' loaded successfully.


2024-09-11 23:02:25,565 - ERROR - Error loading data to Snowflake: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Cleaned_Dataset/dim_date.csv'


2024-09-11 23:02:25,567 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Cleaned_Dataset/dim_date.csv'


2024-09-11 23:02:26,587 - INFO - Retire worker addresses (0,)


2024-09-11 23:02:26,669 - INFO - Closing Nanny at 'tcp://127.0.0.1:52383'. Reason: nanny-close


2024-09-11 23:02:26,670 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 23:02:26,671 - INFO - Stopping worker at tcp://127.0.0.1:52390. Reason: nanny-close


2024-09-11 23:02:26,673 - INFO - Removing Worker plugin shuffle


2024-09-11 23:02:26,678 - INFO - Connection to tcp://127.0.0.1:52380 has been closed.


2024-09-11 23:02:26,679 - INFO - Received 'close-stream' from tcp://127.0.0.1:52392; closing.


2024-09-11 23:02:26,683 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:52390', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726092146.6847613')


2024-09-11 23:02:26,685 - INFO - Lost all workers


2024-09-11 23:02:27,158 - INFO - Closing scheduler. Reason: unknown


2024-09-11 23:02:27,161 - INFO - Scheduler closing all comms


2024-09-11 23:12:44,862 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:12:46,769 - INFO - Starting transformation process...


2024-09-11 23:12:46,770 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 23:12:46,770 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:12:46,770 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:12:46,773 - INFO - Starting data transformation


2024-09-11 23:12:46,773 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:12:47,890 - INFO - Transformed data saved to C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Cleaned_Dataset\cleaned_dataset.csv


2024-09-11 23:12:47,898 - INFO - dim_date data generated and saved!


2024-09-11 23:12:47,899 - INFO - Starting load process...


2024-09-11 23:12:48,839 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 23:12:48,956 - INFO - State start


2024-09-11 23:12:49,022 - INFO -   Scheduler at:     tcp://127.0.0.1:52504


2024-09-11 23:12:49,023 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 23:12:49,023 - INFO - Registering Worker plugin shuffle


2024-09-11 23:12:49,101 - INFO -         Start Nanny at: 'tcp://127.0.0.1:52507'


2024-09-11 23:12:53,162 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:12:55,233 - INFO -       Start worker at:      tcp://127.0.0.1:52513


2024-09-11 23:12:55,234 - INFO -          Listening to:      tcp://127.0.0.1:52513


2024-09-11 23:12:55,235 - INFO -           Worker name:                          0


2024-09-11 23:12:55,235 - INFO -          dashboard at:            127.0.0.1:52514


2024-09-11 23:12:55,236 - INFO - Waiting to connect to:      tcp://127.0.0.1:52504


2024-09-11 23:12:55,237 - INFO - -------------------------------------------------


2024-09-11 23:12:55,237 - INFO -               Threads:                          4


2024-09-11 23:12:55,238 - INFO -                Memory:                  19.84 GiB


2024-09-11 23:12:55,240 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-t9gc3hwx


2024-09-11 23:12:55,241 - INFO - -------------------------------------------------


2024-09-11 23:12:55,272 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:52513', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 23:12:55,280 - INFO - Starting worker compute stream, tcp://127.0.0.1:52513


2024-09-11 23:12:55,282 - INFO - Starting established connection to tcp://127.0.0.1:52515


2024-09-11 23:12:55,282 - INFO - Starting Worker plugin shuffle


2024-09-11 23:12:55,319 - INFO -         Registered to:      tcp://127.0.0.1:52504


2024-09-11 23:12:55,334 - INFO - -------------------------------------------------


2024-09-11 23:12:55,367 - INFO - Starting established connection to tcp://127.0.0.1:52504


2024-09-11 23:12:55,414 - INFO - Receive client connection: Client-fa4e1a9c-708a-11ef-afc8-f4a4751e46e5


2024-09-11 23:12:55,417 - INFO - Starting established connection to tcp://127.0.0.1:52516


2024-09-11 23:12:55,421 - INFO - Dask client initialized with 1 worker.


2024-09-11 23:12:55,549 - INFO - Connected to Snowflake successfully.


2024-09-11 23:12:55,551 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\cleaned_dataset.csv' loaded successfully.


2024-09-11 23:12:55,796 - ERROR - Error loading data to Snowflake: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Cleaned_Dataset/dim_date.csv'


2024-09-11 23:12:55,797 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/Cleaned_Dataset/dim_date.csv'


2024-09-11 23:12:56,079 - INFO - Retire worker addresses (0,)


2024-09-11 23:12:56,083 - INFO - Closing Nanny at 'tcp://127.0.0.1:52507'. Reason: nanny-close


2024-09-11 23:12:56,083 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 23:12:56,086 - INFO - Stopping worker at tcp://127.0.0.1:52513. Reason: nanny-close


2024-09-11 23:12:56,087 - INFO - Removing Worker plugin shuffle


2024-09-11 23:12:56,091 - INFO - Received 'close-stream' from tcp://127.0.0.1:52515; closing.


2024-09-11 23:12:56,091 - INFO - Connection to tcp://127.0.0.1:52504 has been closed.


2024-09-11 23:12:56,096 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:52513', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726092776.0963116')


2024-09-11 23:12:56,100 - INFO - Lost all workers


2024-09-11 23:12:56,611 - INFO - Closing scheduler. Reason: unknown


2024-09-11 23:12:56,613 - INFO - Scheduler closing all comms


2024-09-11 23:16:13,903 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:16:16,153 - INFO - Starting transformation process...


2024-09-11 23:16:16,154 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-11 23:16:16,155 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:16:16,155 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:16:16,158 - INFO - Starting data transformation


2024-09-11 23:16:16,160 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-11 23:16:17,284 - INFO - Transformed data saved to C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Cleaned_Dataset\cleaned_dataset.csv


2024-09-11 23:16:17,292 - INFO - dim_date data generated and saved!


2024-09-11 23:16:17,294 - INFO - Starting load process...


2024-09-11 23:16:18,307 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 23:16:18,430 - INFO - State start


2024-09-11 23:16:18,544 - INFO -   Scheduler at:     tcp://127.0.0.1:52555


2024-09-11 23:16:18,545 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 23:16:18,545 - INFO - Registering Worker plugin shuffle


2024-09-11 23:16:18,661 - INFO -         Start Nanny at: 'tcp://127.0.0.1:52558'


2024-09-11 23:16:23,170 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:16:25,256 - INFO -       Start worker at:      tcp://127.0.0.1:52564


2024-09-11 23:16:25,261 - INFO -          Listening to:      tcp://127.0.0.1:52564


2024-09-11 23:16:25,265 - INFO -           Worker name:                          0


2024-09-11 23:16:25,275 - INFO -          dashboard at:            127.0.0.1:52565


2024-09-11 23:16:25,289 - INFO - Waiting to connect to:      tcp://127.0.0.1:52555


2024-09-11 23:16:25,293 - INFO - -------------------------------------------------


2024-09-11 23:16:25,356 - INFO -               Threads:                          4


2024-09-11 23:16:25,358 - INFO -                Memory:                  19.84 GiB


2024-09-11 23:16:25,360 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-nhqnhbqy


2024-09-11 23:16:25,372 - INFO - -------------------------------------------------


2024-09-11 23:16:25,393 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:52564', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 23:16:25,397 - INFO - Starting worker compute stream, tcp://127.0.0.1:52564


2024-09-11 23:16:25,403 - INFO - Starting established connection to tcp://127.0.0.1:52566


2024-09-11 23:16:25,409 - INFO - Starting Worker plugin shuffle


2024-09-11 23:16:25,441 - INFO -         Registered to:      tcp://127.0.0.1:52555


2024-09-11 23:16:25,473 - INFO - -------------------------------------------------


2024-09-11 23:16:25,511 - INFO - Starting established connection to tcp://127.0.0.1:52555


2024-09-11 23:16:25,596 - INFO - Receive client connection: Client-771d7186-708b-11ef-b050-f4a4751e46e5


2024-09-11 23:16:25,599 - INFO - Starting established connection to tcp://127.0.0.1:52567


2024-09-11 23:16:25,602 - INFO - Dask client initialized with 1 worker.


2024-09-11 23:16:25,656 - INFO - Connected to Snowflake successfully.


2024-09-11 23:16:25,658 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\dim_date.csv' loaded successfully.


2024-09-11 23:16:26,208 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-11 23:16:26,209 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-11 23:16:26,211 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-11 23:16:33,974 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:34,591 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:35,302 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:35,302 - INFO - Table "Dim_Employee" created or already exists.


2024-09-11 23:16:36,025 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:36,025 - INFO - Truncated "Dim_Employee" successfully.


2024-09-11 23:16:36,428 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:36,428 - INFO - Table "Dim_Agency" created or already exists.


2024-09-11 23:16:37,967 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:37,970 - INFO - Truncated "Dim_Agency" successfully.


2024-09-11 23:16:38,439 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:38,440 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-11 23:16:39,399 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:39,400 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-11 23:16:39,914 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:39,917 - INFO - Table "Dim_Date" created or already exists.


2024-09-11 23:16:40,594 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:40,596 - INFO - Truncated "Dim_Date" successfully.


2024-09-11 23:16:41,054 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:41,113 - INFO - Table "FactPayroll" created or already exists.


2024-09-11 23:16:42,368 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:42,369 - INFO - Truncated "FactPayroll" successfully.


2024-09-11 23:16:44,177 - INFO - Number of results in first chunk: 1


2024-09-11 23:16:44,178 - ERROR - Error loading data to Snowflake: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'TitleCode',\n       'TitleDescription', 'WorkLocationBorough', 'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-11 23:16:44,182 - ERROR - ETL pipeline failed: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'TitleCode',\n       'TitleDescription', 'WorkLocationBorough', 'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-11 23:16:44,371 - INFO - closed


2024-09-11 23:16:44,372 - INFO - No async queries seem to be running, deleting session


2024-09-11 23:16:44,825 - INFO - Retire worker addresses (0,)


2024-09-11 23:16:44,827 - INFO - Closing Nanny at 'tcp://127.0.0.1:52558'. Reason: nanny-close


2024-09-11 23:16:44,831 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 23:16:44,835 - INFO - Stopping worker at tcp://127.0.0.1:52564. Reason: nanny-close


2024-09-11 23:16:44,838 - INFO - Removing Worker plugin shuffle


2024-09-11 23:16:44,843 - INFO - Received 'close-stream' from tcp://127.0.0.1:52566; closing.


2024-09-11 23:16:44,844 - INFO - Connection to tcp://127.0.0.1:52555 has been closed.


2024-09-11 23:16:44,852 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:52564', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726093004.8527346')


2024-09-11 23:16:44,857 - INFO - Lost all workers


2024-09-11 23:16:45,412 - INFO - Closing scheduler. Reason: unknown


2024-09-11 23:16:45,415 - INFO - Scheduler closing all comms


2024-09-11 23:42:32,920 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:44:30,403 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:44:33,796 - INFO - Starting load process...


2024-09-11 23:44:35,113 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-11 23:44:35,190 - INFO - State start


2024-09-11 23:44:35,266 - INFO -   Scheduler at:     tcp://127.0.0.1:52855


2024-09-11 23:44:35,266 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-11 23:44:35,267 - INFO - Registering Worker plugin shuffle


2024-09-11 23:44:35,351 - INFO -         Start Nanny at: 'tcp://127.0.0.1:52858'


2024-09-11 23:44:38,654 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-11 23:44:40,834 - INFO -       Start worker at:      tcp://127.0.0.1:52864


2024-09-11 23:44:40,834 - INFO -          Listening to:      tcp://127.0.0.1:52864


2024-09-11 23:44:40,835 - INFO -           Worker name:                          0


2024-09-11 23:44:40,835 - INFO -          dashboard at:            127.0.0.1:52865


2024-09-11 23:44:40,837 - INFO - Waiting to connect to:      tcp://127.0.0.1:52855


2024-09-11 23:44:40,837 - INFO - -------------------------------------------------


2024-09-11 23:44:40,838 - INFO -               Threads:                          4


2024-09-11 23:44:40,838 - INFO -                Memory:                  19.84 GiB


2024-09-11 23:44:40,838 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-27oxdslk


2024-09-11 23:44:40,839 - INFO - -------------------------------------------------


2024-09-11 23:44:40,849 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:52864', name: 0, status: init, memory: 0, processing: 0>


2024-09-11 23:44:40,853 - INFO - Starting worker compute stream, tcp://127.0.0.1:52864


2024-09-11 23:44:40,854 - INFO - Starting Worker plugin shuffle


2024-09-11 23:44:40,854 - INFO - Starting established connection to tcp://127.0.0.1:52866


2024-09-11 23:44:40,856 - INFO -         Registered to:      tcp://127.0.0.1:52855


2024-09-11 23:44:40,860 - INFO - -------------------------------------------------


2024-09-11 23:44:40,862 - INFO - Starting established connection to tcp://127.0.0.1:52855


2024-09-11 23:44:40,920 - INFO - Receive client connection: Client-6a4f1c9d-708f-11ef-abb8-f4a4751e46e5


2024-09-11 23:44:40,921 - INFO - Starting established connection to tcp://127.0.0.1:52867


2024-09-11 23:44:40,928 - INFO - Dask client initialized with 1 worker.


2024-09-11 23:44:40,972 - INFO - Connected to Snowflake successfully.


2024-09-11 23:44:40,979 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\dim_date.csv' loaded successfully.


2024-09-11 23:44:41,038 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-11 23:44:41,040 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-11 23:44:41,043 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-11 23:44:44,195 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:44,627 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:45,085 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:45,086 - INFO - Table "Dim_Employee" created or already exists.


2024-09-11 23:44:45,625 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:45,626 - INFO - Truncated "Dim_Employee" successfully.


2024-09-11 23:44:46,034 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:46,035 - INFO - Table "Dim_Agency" created or already exists.


2024-09-11 23:44:46,488 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:46,489 - INFO - Truncated "Dim_Agency" successfully.


2024-09-11 23:44:46,853 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:46,854 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-11 23:44:47,332 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:47,333 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-11 23:44:48,047 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:48,047 - INFO - Table "Dim_Date" created or already exists.


2024-09-11 23:44:48,594 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:48,595 - INFO - Truncated "Dim_Date" successfully.


2024-09-11 23:44:48,985 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:48,988 - INFO - Table "FactPayroll" created or already exists.


2024-09-11 23:44:49,490 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:49,491 - INFO - Truncated "FactPayroll" successfully.


2024-09-11 23:44:50,033 - INFO - Number of results in first chunk: 1


2024-09-11 23:44:50,033 - ERROR - Error loading data to Snowflake: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'TitleCode',\n       'TitleDescription', 'WorkLocationBorough', 'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-11 23:44:50,035 - ERROR - ETL pipeline failed: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'TitleCode',\n       'TitleDescription', 'WorkLocationBorough', 'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-11 23:44:50,061 - INFO - closed


2024-09-11 23:44:50,062 - INFO - No async queries seem to be running, deleting session


2024-09-11 23:44:50,458 - INFO - Retire worker addresses (0,)


2024-09-11 23:44:50,460 - INFO - Closing Nanny at 'tcp://127.0.0.1:52858'. Reason: nanny-close


2024-09-11 23:44:50,461 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-11 23:44:50,463 - INFO - Stopping worker at tcp://127.0.0.1:52864. Reason: nanny-close


2024-09-11 23:44:50,466 - INFO - Removing Worker plugin shuffle


2024-09-11 23:44:50,470 - INFO - Received 'close-stream' from tcp://127.0.0.1:52866; closing.


2024-09-11 23:44:50,470 - INFO - Connection to tcp://127.0.0.1:52855 has been closed.


2024-09-11 23:44:50,477 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:52864', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726094690.4770973')


2024-09-11 23:44:50,479 - INFO - Lost all workers


2024-09-11 23:44:51,098 - INFO - Closing scheduler. Reason: unknown


2024-09-11 23:44:51,099 - INFO - Scheduler closing all comms


2024-09-12 00:14:41,108 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:14:43,802 - INFO - Starting load process...


2024-09-12 00:14:44,730 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 00:14:44,792 - INFO - State start


2024-09-12 00:14:44,872 - INFO -   Scheduler at:     tcp://127.0.0.1:55969


2024-09-12 00:14:44,872 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 00:14:44,873 - INFO - Registering Worker plugin shuffle


2024-09-12 00:14:44,991 - INFO -         Start Nanny at: 'tcp://127.0.0.1:55972'


2024-09-12 00:14:48,823 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:14:51,140 - INFO -       Start worker at:      tcp://127.0.0.1:55978


2024-09-12 00:14:51,142 - INFO -          Listening to:      tcp://127.0.0.1:55978


2024-09-12 00:14:51,143 - INFO -           Worker name:                          0


2024-09-12 00:14:51,143 - INFO -          dashboard at:            127.0.0.1:55979


2024-09-12 00:14:51,146 - INFO - Waiting to connect to:      tcp://127.0.0.1:55969


2024-09-12 00:14:51,146 - INFO - -------------------------------------------------


2024-09-12 00:14:51,149 - INFO -               Threads:                          4


2024-09-12 00:14:51,150 - INFO -                Memory:                  19.84 GiB


2024-09-12 00:14:51,155 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-hghvf7b1


2024-09-12 00:14:51,157 - INFO - -------------------------------------------------


2024-09-12 00:14:51,178 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:55978', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 00:14:51,188 - INFO - Starting worker compute stream, tcp://127.0.0.1:55978


2024-09-12 00:14:51,189 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:55980


2024-09-12 00:14:51,193 - INFO -         Registered to:      tcp://127.0.0.1:55969


2024-09-12 00:14:51,202 - INFO - -------------------------------------------------


2024-09-12 00:14:51,206 - INFO - Starting established connection to tcp://127.0.0.1:55969


2024-09-12 00:14:51,251 - INFO - Receive client connection: Client-a1280327-7093-11ef-a758-f4a4751e46e5


2024-09-12 00:14:51,252 - INFO - Starting established connection to tcp://127.0.0.1:55981


2024-09-12 00:14:51,257 - INFO - Dask client initialized with 1 worker.


2024-09-12 00:14:51,332 - INFO - Connected to Snowflake successfully.


2024-09-12 00:14:51,333 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\dim_date.csv' loaded successfully.


2024-09-12 00:14:51,431 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 00:14:51,433 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 00:14:51,433 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 00:14:54,800 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:55,143 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:55,592 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:55,593 - INFO - Table "Dim_Employee" created or already exists.


2024-09-12 00:14:56,085 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:56,086 - INFO - Truncated "Dim_Employee" successfully.


2024-09-12 00:14:56,481 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:56,482 - INFO - Table "Dim_Agency" created or already exists.


2024-09-12 00:14:57,023 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:57,024 - INFO - Truncated "Dim_Agency" successfully.


2024-09-12 00:14:57,516 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:57,518 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-12 00:14:57,958 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:57,959 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-12 00:14:58,655 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:58,656 - INFO - Table "Dim_Date" created or already exists.


2024-09-12 00:14:59,290 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:59,291 - INFO - Truncated "Dim_Date" successfully.


2024-09-12 00:14:59,614 - INFO - Number of results in first chunk: 1


2024-09-12 00:14:59,615 - INFO - Table "FactPayroll" created or already exists.


2024-09-12 00:15:00,109 - INFO - Number of results in first chunk: 1


2024-09-12 00:15:00,111 - INFO - Truncated "FactPayroll" successfully.


2024-09-12 00:15:00,615 - INFO - Number of results in first chunk: 1


2024-09-12 00:15:00,617 - ERROR - Error loading data to Snowflake: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate',\n       'WorkLocationBorough', 'TitleCode', 'TitleDescription',\n       'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-12 00:15:00,620 - ERROR - ETL pipeline failed: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate',\n       'WorkLocationBorough', 'TitleCode', 'TitleDescription',\n       'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-12 00:15:00,825 - INFO - closed


2024-09-12 00:15:00,826 - INFO - No async queries seem to be running, deleting session


2024-09-12 00:15:01,153 - INFO - Retire worker addresses (0,)


2024-09-12 00:15:01,155 - INFO - Closing Nanny at 'tcp://127.0.0.1:55972'. Reason: nanny-close


2024-09-12 00:15:01,157 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 00:15:01,159 - INFO - Stopping worker at tcp://127.0.0.1:55978. Reason: nanny-close


2024-09-12 00:15:01,162 - INFO - Removing Worker plugin shuffle


2024-09-12 00:15:01,167 - INFO - Received 'close-stream' from tcp://127.0.0.1:55980; closing.


2024-09-12 00:15:01,167 - INFO - Connection to tcp://127.0.0.1:55969 has been closed.


2024-09-12 00:15:01,174 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:55978', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726096501.1742308')


2024-09-12 00:15:01,176 - INFO - Lost all workers


2024-09-12 00:15:01,952 - INFO - Closing scheduler. Reason: unknown


2024-09-12 00:15:01,964 - INFO - Scheduler closing all comms


2024-09-12 00:33:41,077 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:33:43,410 - INFO - Starting load process...


2024-09-12 00:33:44,500 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 00:33:44,621 - INFO - State start


2024-09-12 00:33:44,686 - INFO -   Scheduler at:     tcp://127.0.0.1:60804


2024-09-12 00:33:44,687 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 00:33:44,689 - INFO - Registering Worker plugin shuffle


2024-09-12 00:33:44,768 - INFO -         Start Nanny at: 'tcp://127.0.0.1:60807'


2024-09-12 00:33:48,192 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:33:50,491 - INFO -       Start worker at:      tcp://127.0.0.1:60813


2024-09-12 00:33:50,492 - INFO -          Listening to:      tcp://127.0.0.1:60813


2024-09-12 00:33:50,492 - INFO -           Worker name:                          0


2024-09-12 00:33:50,493 - INFO -          dashboard at:            127.0.0.1:60814


2024-09-12 00:33:50,493 - INFO - Waiting to connect to:      tcp://127.0.0.1:60804


2024-09-12 00:33:50,494 - INFO - -------------------------------------------------


2024-09-12 00:33:50,494 - INFO -               Threads:                          4


2024-09-12 00:33:50,496 - INFO -                Memory:                  19.84 GiB


2024-09-12 00:33:50,496 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-y5ijfyjt


2024-09-12 00:33:50,497 - INFO - -------------------------------------------------


2024-09-12 00:33:50,508 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:60813', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 00:33:50,513 - INFO - Starting worker compute stream, tcp://127.0.0.1:60813


2024-09-12 00:33:50,514 - INFO - Starting Worker plugin shuffle


2024-09-12 00:33:50,515 - INFO - Starting established connection to tcp://127.0.0.1:60815


2024-09-12 00:33:50,520 - INFO -         Registered to:      tcp://127.0.0.1:60804


2024-09-12 00:33:50,521 - INFO - -------------------------------------------------


2024-09-12 00:33:50,523 - INFO - Starting established connection to tcp://127.0.0.1:60804


2024-09-12 00:33:50,554 - INFO - Receive client connection: Client-486a6ce9-7096-11ef-b718-f4a4751e46e5


2024-09-12 00:33:50,558 - INFO - Starting established connection to tcp://127.0.0.1:60816


2024-09-12 00:33:50,560 - INFO - Dask client initialized with 1 worker.


2024-09-12 00:33:50,609 - INFO - Connected to Snowflake successfully.


2024-09-12 00:33:50,611 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset\dim_date.csv' loaded successfully.


2024-09-12 00:33:50,647 - INFO - Columns in transformed DataFrame: ['DateID', 'Date', 'Year', 'Month', 'Day', 'Quarter']


2024-09-12 00:33:50,680 - INFO - Columns in Dim_Date_df: ['DateID', 'Date', 'Year', 'Month', 'Day', 'Quarter']


2024-09-12 00:33:50,682 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 00:33:50,690 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 00:33:50,691 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 00:33:54,521 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:55,023 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:55,932 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:55,937 - INFO - Table "Dim_Employee" created or already exists.


2024-09-12 00:33:57,070 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:57,072 - INFO - Truncated "Dim_Employee" successfully.


2024-09-12 00:33:57,416 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:57,418 - INFO - Table "Dim_Agency" created or already exists.


2024-09-12 00:33:57,797 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:57,799 - INFO - Truncated "Dim_Agency" successfully.


2024-09-12 00:33:58,168 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:58,169 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-12 00:33:58,725 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:58,726 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-12 00:33:59,082 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:59,084 - INFO - Table "Dim_Date" created or already exists.


2024-09-12 00:33:59,614 - INFO - Number of results in first chunk: 1


2024-09-12 00:33:59,617 - INFO - Truncated "Dim_Date" successfully.


2024-09-12 00:34:00,090 - INFO - Number of results in first chunk: 1


2024-09-12 00:34:00,091 - INFO - Table "FactPayroll" created or already exists.


2024-09-12 00:34:00,755 - INFO - Number of results in first chunk: 1


2024-09-12 00:34:00,756 - INFO - Truncated "FactPayroll" successfully.


2024-09-12 00:34:01,372 - INFO - Number of results in first chunk: 1


2024-09-12 00:34:01,374 - ERROR - Error loading data to Snowflake: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate',\n       'WorkLocationBorough', 'TitleCode', 'TitleDescription',\n       'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-12 00:34:01,378 - ERROR - ETL pipeline failed: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate',\n       'WorkLocationBorough', 'TitleCode', 'TitleDescription',\n       'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-12 00:34:01,587 - INFO - closed


2024-09-12 00:34:01,589 - INFO - No async queries seem to be running, deleting session


2024-09-12 00:34:01,877 - INFO - Retire worker addresses (0,)


2024-09-12 00:34:01,880 - INFO - Closing Nanny at 'tcp://127.0.0.1:60807'. Reason: nanny-close


2024-09-12 00:34:01,882 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 00:34:01,887 - INFO - Stopping worker at tcp://127.0.0.1:60813. Reason: nanny-close


2024-09-12 00:34:01,889 - INFO - Removing Worker plugin shuffle


2024-09-12 00:34:01,894 - INFO - Received 'close-stream' from tcp://127.0.0.1:60815; closing.


2024-09-12 00:34:01,894 - INFO - Connection to tcp://127.0.0.1:60804 has been closed.


2024-09-12 00:34:01,897 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:60813', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726097641.8973732')


2024-09-12 00:34:01,909 - INFO - Lost all workers


2024-09-12 00:34:02,576 - INFO - Closing scheduler. Reason: unknown


2024-09-12 00:34:02,577 - INFO - Scheduler closing all comms


2024-09-12 00:53:07,889 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:53:09,764 - INFO - Starting load process...


2024-09-12 00:53:11,224 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 00:53:11,329 - INFO - State start


2024-09-12 00:53:11,433 - INFO -   Scheduler at:     tcp://127.0.0.1:61045


2024-09-12 00:53:11,435 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 00:53:11,451 - INFO - Registering Worker plugin shuffle


2024-09-12 00:53:11,578 - INFO -         Start Nanny at: 'tcp://127.0.0.1:61048'


2024-09-12 00:53:15,278 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:53:17,817 - INFO -       Start worker at:      tcp://127.0.0.1:61054


2024-09-12 00:53:17,820 - INFO -          Listening to:      tcp://127.0.0.1:61054


2024-09-12 00:53:17,822 - INFO -           Worker name:                          0


2024-09-12 00:53:17,823 - INFO -          dashboard at:            127.0.0.1:61055


2024-09-12 00:53:17,824 - INFO - Waiting to connect to:      tcp://127.0.0.1:61045


2024-09-12 00:53:17,830 - INFO - -------------------------------------------------


2024-09-12 00:53:17,835 - INFO -               Threads:                          4


2024-09-12 00:53:17,853 - INFO -                Memory:                  19.84 GiB


2024-09-12 00:53:17,869 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-uh886ljy


2024-09-12 00:53:17,882 - INFO - -------------------------------------------------


2024-09-12 00:53:17,920 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:61054', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 00:53:17,927 - INFO - Starting worker compute stream, tcp://127.0.0.1:61054


2024-09-12 00:53:17,928 - INFO - Starting Worker plugin shuffle


2024-09-12 00:53:17,928 - INFO - Starting established connection to tcp://127.0.0.1:61056


2024-09-12 00:53:17,989 - INFO -         Registered to:      tcp://127.0.0.1:61045


2024-09-12 00:53:17,997 - INFO - -------------------------------------------------


2024-09-12 00:53:18,054 - INFO - Starting established connection to tcp://127.0.0.1:61045


2024-09-12 00:53:18,124 - INFO - Receive client connection: Client-ff9e03b6-7098-11ef-b0dc-f4a4751e46e5


2024-09-12 00:53:18,125 - INFO - Starting established connection to tcp://127.0.0.1:61057


2024-09-12 00:53:18,129 - INFO - Dask client initialized with 1 worker.


2024-09-12 00:53:18,213 - INFO - Connected to Snowflake successfully.


2024-09-12 00:53:18,228 - ERROR - Error loading data to Snowflake: [WinError 267] The directory name is invalid: 'All_Dataset/Cleaned_Dataset/cleaned_dataset.csv'


2024-09-12 00:53:18,234 - ERROR - ETL pipeline failed: [WinError 267] The directory name is invalid: 'All_Dataset/Cleaned_Dataset/cleaned_dataset.csv'


2024-09-12 00:53:18,384 - INFO - Retire worker addresses (0,)


2024-09-12 00:53:18,388 - INFO - Closing Nanny at 'tcp://127.0.0.1:61048'. Reason: nanny-close


2024-09-12 00:53:18,393 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 00:53:18,396 - INFO - Stopping worker at tcp://127.0.0.1:61054. Reason: nanny-close


2024-09-12 00:53:18,398 - INFO - Removing Worker plugin shuffle


2024-09-12 00:53:18,402 - INFO - Received 'close-stream' from tcp://127.0.0.1:61056; closing.


2024-09-12 00:53:18,402 - INFO - Connection to tcp://127.0.0.1:61045 has been closed.


2024-09-12 00:53:18,413 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:61054', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726098798.4127219')


2024-09-12 00:53:18,415 - INFO - Lost all workers


2024-09-12 00:53:18,964 - INFO - Closing scheduler. Reason: unknown


2024-09-12 00:53:18,965 - INFO - Scheduler closing all comms


2024-09-12 00:59:05,958 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:59:08,630 - INFO - Starting load process...


2024-09-12 00:59:09,968 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 00:59:10,046 - INFO - State start


2024-09-12 00:59:10,144 - INFO -   Scheduler at:     tcp://127.0.0.1:61111


2024-09-12 00:59:10,145 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 00:59:10,147 - INFO - Registering Worker plugin shuffle


2024-09-12 00:59:10,599 - INFO -         Start Nanny at: 'tcp://127.0.0.1:61114'


2024-09-12 00:59:14,475 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 00:59:17,442 - INFO -       Start worker at:      tcp://127.0.0.1:61120


2024-09-12 00:59:17,445 - INFO -          Listening to:      tcp://127.0.0.1:61120


2024-09-12 00:59:17,446 - INFO -           Worker name:                          0


2024-09-12 00:59:17,447 - INFO -          dashboard at:            127.0.0.1:61121


2024-09-12 00:59:17,447 - INFO - Waiting to connect to:      tcp://127.0.0.1:61111


2024-09-12 00:59:17,449 - INFO - -------------------------------------------------


2024-09-12 00:59:17,449 - INFO -               Threads:                          4


2024-09-12 00:59:17,454 - INFO -                Memory:                  19.84 GiB


2024-09-12 00:59:17,457 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-7r5r_1nr


2024-09-12 00:59:17,459 - INFO - -------------------------------------------------


2024-09-12 00:59:17,470 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:61120', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 00:59:17,480 - INFO - Starting worker compute stream, tcp://127.0.0.1:61120


2024-09-12 00:59:17,482 - INFO - Starting Worker plugin shuffle


2024-09-12 00:59:17,482 - INFO - Starting established connection to tcp://127.0.0.1:61122


2024-09-12 00:59:17,496 - INFO -         Registered to:      tcp://127.0.0.1:61111


2024-09-12 00:59:17,497 - INFO - -------------------------------------------------


2024-09-12 00:59:17,512 - INFO - Starting established connection to tcp://127.0.0.1:61111


2024-09-12 00:59:17,564 - INFO - Receive client connection: Client-d58495b1-7099-11ef-bb44-f4a4751e46e5


2024-09-12 00:59:17,566 - INFO - Starting established connection to tcp://127.0.0.1:61123


2024-09-12 00:59:17,576 - INFO - Dask client initialized with 1 worker.


2024-09-12 00:59:17,688 - INFO - Connected to Snowflake successfully.


2024-09-12 00:59:17,690 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset/dim_date.csv' loaded successfully.


2024-09-12 00:59:17,742 - INFO - Columns in transformed DataFrame: ['DateID', 'Date', 'Year', 'Month', 'Day', 'Quarter']


2024-09-12 00:59:17,747 - INFO - Columns in Dim_Date_df: ['DateID', 'Date', 'Year', 'Month', 'Day', 'Quarter']


2024-09-12 00:59:17,750 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 00:59:17,758 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 00:59:17,760 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 00:59:21,262 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:21,689 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:22,077 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:22,217 - INFO - Table "Dim_Employee" created or already exists.


2024-09-12 00:59:22,782 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:22,784 - INFO - Truncated "Dim_Employee" successfully.


2024-09-12 00:59:23,279 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:23,281 - INFO - Table "Dim_Agency" created or already exists.


2024-09-12 00:59:23,763 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:23,764 - INFO - Truncated "Dim_Agency" successfully.


2024-09-12 00:59:24,119 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:24,124 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-12 00:59:24,527 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:24,529 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-12 00:59:24,937 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:24,938 - INFO - Table "Dim_Date" created or already exists.


2024-09-12 00:59:25,408 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:25,409 - INFO - Truncated "Dim_Date" successfully.


2024-09-12 00:59:25,754 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:25,756 - INFO - Table "FactPayroll" created or already exists.


2024-09-12 00:59:26,181 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:26,255 - INFO - Truncated "FactPayroll" successfully.


2024-09-12 00:59:26,777 - INFO - Number of results in first chunk: 1


2024-09-12 00:59:26,778 - ERROR - Error loading data to Snowflake: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate',\n       'WorkLocationBorough', 'TitleCode', 'TitleDescription',\n       'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-12 00:59:26,779 - ERROR - ETL pipeline failed: "None of [Index(['EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate',\n       'WorkLocationBorough', 'TitleCode', 'TitleDescription',\n       'LeaveStatusasofJune30'],\n      dtype='object')] are in the [columns]"


2024-09-12 00:59:26,848 - INFO - closed


2024-09-12 00:59:26,849 - INFO - No async queries seem to be running, deleting session


2024-09-12 00:59:27,189 - INFO - Retire worker addresses (0,)


2024-09-12 00:59:27,191 - INFO - Closing Nanny at 'tcp://127.0.0.1:61114'. Reason: nanny-close


2024-09-12 00:59:27,192 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 00:59:27,194 - INFO - Stopping worker at tcp://127.0.0.1:61120. Reason: nanny-close


2024-09-12 00:59:27,195 - INFO - Removing Worker plugin shuffle


2024-09-12 00:59:27,200 - INFO - Received 'close-stream' from tcp://127.0.0.1:61122; closing.


2024-09-12 00:59:27,200 - INFO - Connection to tcp://127.0.0.1:61111 has been closed.


2024-09-12 00:59:27,207 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:61120', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726099167.2068167')


2024-09-12 00:59:27,209 - INFO - Lost all workers


2024-09-12 00:59:27,898 - INFO - Closing scheduler. Reason: unknown


2024-09-12 00:59:27,901 - INFO - Scheduler closing all comms


2024-09-12 01:06:16,326 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:06:18,392 - INFO - Starting load process...


2024-09-12 01:06:19,327 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 01:06:19,392 - INFO - State start


2024-09-12 01:06:19,456 - INFO -   Scheduler at:     tcp://127.0.0.1:62172


2024-09-12 01:06:19,456 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 01:06:19,457 - INFO - Registering Worker plugin shuffle


2024-09-12 01:06:19,526 - INFO -         Start Nanny at: 'tcp://127.0.0.1:62175'


2024-09-12 01:06:23,164 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:06:25,898 - INFO -       Start worker at:      tcp://127.0.0.1:62181


2024-09-12 01:06:25,909 - INFO -          Listening to:      tcp://127.0.0.1:62181


2024-09-12 01:06:25,909 - INFO -           Worker name:                          0


2024-09-12 01:06:25,910 - INFO -          dashboard at:            127.0.0.1:62182


2024-09-12 01:06:25,913 - INFO - Waiting to connect to:      tcp://127.0.0.1:62172


2024-09-12 01:06:25,914 - INFO - -------------------------------------------------


2024-09-12 01:06:25,916 - INFO -               Threads:                          4


2024-09-12 01:06:25,916 - INFO -                Memory:                  19.84 GiB


2024-09-12 01:06:25,917 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-mw9k3art


2024-09-12 01:06:25,918 - INFO - -------------------------------------------------


2024-09-12 01:06:25,934 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:62181', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 01:06:25,941 - INFO - Starting worker compute stream, tcp://127.0.0.1:62181


2024-09-12 01:06:25,941 - INFO - Starting Worker plugin shuffle


cp://127.0.0.1:62183


2024-09-12 01:06:25,974 - INFO -         Registered to:      tcp://127.0.0.1:62172


2024-09-12 01:06:25,991 - INFO - -------------------------------------------------


2024-09-12 01:06:26,057 - INFO - Starting established connection to tcp://127.0.0.1:62172


2024-09-12 01:06:26,126 - INFO - Receive client connection: Client-d5ad0e3f-709a-11ef-aca4-f4a4751e46e5


2024-09-12 01:06:26,128 - INFO - Starting established connection to tcp://127.0.0.1:62184


2024-09-12 01:06:26,132 - INFO - Dask client initialized with 1 worker.


2024-09-12 01:06:26,177 - INFO - Connected to Snowflake successfully.


2024-09-12 01:06:26,180 - ERROR - Error loading data to Snowflake: No CSV files found in All_Dataset/Cleaned_Dataset/


2024-09-12 01:06:26,183 - ERROR - ETL pipeline failed: No CSV files found in All_Dataset/Cleaned_Dataset/


2024-09-12 01:06:26,207 - INFO - Retire worker addresses (0,)


2024-09-12 01:06:26,209 - INFO - Closing Nanny at 'tcp://127.0.0.1:62175'. Reason: nanny-close


2024-09-12 01:06:26,210 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 01:06:26,213 - INFO - Stopping worker at tcp://127.0.0.1:62181. Reason: nanny-close


2024-09-12 01:06:26,214 - INFO - Removing Worker plugin shuffle


2024-09-12 01:06:26,217 - INFO - Received 'close-stream' from tcp://127.0.0.1:62183; closing.


2024-09-12 01:06:26,218 - INFO - Connection to tcp://127.0.0.1:62172 has been closed.


2024-09-12 01:06:26,219 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:62181', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726099586.2192092')


2024-09-12 01:06:26,224 - INFO - Lost all workers


2024-09-12 01:06:26,783 - INFO - Closing scheduler. Reason: unknown


2024-09-12 01:06:26,784 - INFO - Scheduler closing all comms


2024-09-12 01:07:05,191 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:07:07,484 - INFO - Starting transformation process...


2024-09-12 01:07:07,485 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-12 01:07:07,486 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-12 01:07:07,486 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-12 01:07:07,488 - INFO - Starting data transformation


2024-09-12 01:07:07,490 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2020.csv


2024-09-12 01:07:08,656 - INFO - Transformed data saved to C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Cleaned_Dataset\cleaned_dataset.csv


2024-09-12 01:07:08,752 - INFO - dim_date data generated and saved!


2024-09-12 01:07:08,773 - INFO - Starting load process...


2024-09-12 01:07:11,307 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 01:07:11,517 - INFO - State start


2024-09-12 01:07:12,018 - INFO -   Scheduler at:     tcp://127.0.0.1:62191


2024-09-12 01:07:12,021 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 01:07:12,040 - INFO - Registering Worker plugin shuffle


2024-09-12 01:07:12,418 - INFO -         Start Nanny at: 'tcp://127.0.0.1:62194'


2024-09-12 01:07:17,623 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:07:20,044 - INFO -       Start worker at:      tcp://127.0.0.1:62201


2024-09-12 01:07:20,045 - INFO -          Listening to:      tcp://127.0.0.1:62201


2024-09-12 01:07:20,045 - INFO -           Worker name:                          0


2024-09-12 01:07:20,046 - INFO -          dashboard at:            127.0.0.1:62202


2024-09-12 01:07:20,046 - INFO - Waiting to connect to:      tcp://127.0.0.1:62191


2024-09-12 01:07:20,047 - INFO - -------------------------------------------------


2024-09-12 01:07:20,048 - INFO -               Threads:                          4


2024-09-12 01:07:20,048 - INFO -                Memory:                  19.84 GiB


2024-09-12 01:07:20,049 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-dzdd5xl1


2024-09-12 01:07:20,051 - INFO - -------------------------------------------------


2024-09-12 01:07:20,127 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:62201', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 01:07:20,138 - INFO - Starting worker compute stream, tcp://127.0.0.1:62201


2024-09-12 01:07:20,138 - INFO - Starting Worker plugin shuffle


2024-09-12 01:07:20,139 - INFO - Starting established connection to tcp://127.0.0.1:62203


2024-09-12 01:07:20,151 - INFO -         Registered to:      tcp://127.0.0.1:62191


2024-09-12 01:07:20,166 - INFO - -------------------------------------------------


2024-09-12 01:07:20,171 - INFO - Starting established connection to tcp://127.0.0.1:62191


2024-09-12 01:07:20,221 - INFO - Receive client connection: Client-f3b68b4f-709a-11ef-bbf0-f4a4751e46e5


2024-09-12 01:07:20,222 - INFO - Starting established connection to tcp://127.0.0.1:62204


2024-09-12 01:07:20,229 - INFO - Dask client initialized with 1 worker.


2024-09-12 01:07:20,280 - INFO - Connected to Snowflake successfully.


2024-09-12 01:07:20,283 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset/cleaned_dataset.csv' loaded successfully.


2024-09-12 01:07:20,448 - INFO - Columns in transformed DataFrame: ['FiscalYear', 'PayrollNumber', 'AgencyID', 'AgencyName', 'EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'WorkLocationBorough', 'TitleCode', 'TitleDescription', 'LeaveStatusasofJune30', 'BaseSalary', 'PayBasis', 'RegularHours', 'RegularGrossPaid', 'OTHours', 'TotalOTPaid', 'TotalOtherPay', 'PayBasisID']


2024-09-12 01:07:20,450 - ERROR - Error loading data to Snowflake: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/dim_date.csv'


2024-09-12 01:07:20,452 - ERROR - ETL pipeline failed: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: An error occurred while calling the read_csv method registered to the pandas backend.
Original Message: [WinError 2] The system cannot find the file specified: 'C:/Users/oluwa/OneDrive/Documents/Data Engineering Training - 10Alytics/Project - Capstone/NYCPayroll_Pipeline/All_Dataset/dim_date.csv'


2024-09-12 01:07:21,141 - INFO - Retire worker addresses (0,)


2024-09-12 01:07:21,152 - INFO - Closing Nanny at 'tcp://127.0.0.1:62194'. Reason: nanny-close


2024-09-12 01:07:21,154 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 01:07:21,157 - INFO - Stopping worker at tcp://127.0.0.1:62201. Reason: nanny-close


2024-09-12 01:07:21,203 - INFO - Removing Worker plugin shuffle


2024-09-12 01:07:21,208 - INFO - Connection to tcp://127.0.0.1:62191 has been closed.


2024-09-12 01:07:21,231 - INFO - Received 'close-stream' from tcp://127.0.0.1:62203; closing.


2024-09-12 01:07:21,234 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:62201', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726099641.2333717')


2024-09-12 01:07:21,236 - INFO - Lost all workers


2024-09-12 01:07:21,968 - INFO - Closing scheduler. Reason: unknown


2024-09-12 01:07:21,970 - INFO - Scheduler closing all comms


2024-09-12 01:11:34,036 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:11:37,601 - INFO - Starting load process...


2024-09-12 01:11:38,386 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 01:11:38,518 - INFO - State start


2024-09-12 01:11:38,616 - INFO -   Scheduler at:     tcp://127.0.0.1:62215


2024-09-12 01:11:38,618 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 01:11:38,619 - INFO - Registering Worker plugin shuffle


2024-09-12 01:11:38,708 - INFO -         Start Nanny at: 'tcp://127.0.0.1:62218'


2024-09-12 01:11:42,143 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:11:44,486 - INFO -       Start worker at:      tcp://127.0.0.1:62224


2024-09-12 01:11:44,486 - INFO -          Listening to:      tcp://127.0.0.1:62224


2024-09-12 01:11:44,487 - INFO -           Worker name:                          0


2024-09-12 01:11:44,487 - INFO -          dashboard at:            127.0.0.1:62225


2024-09-12 01:11:44,488 - INFO - Waiting to connect to:      tcp://127.0.0.1:62215


2024-09-12 01:11:44,489 - INFO - -------------------------------------------------


2024-09-12 01:11:44,489 - INFO -               Threads:                          4


2024-09-12 01:11:44,490 - INFO -                Memory:                  19.84 GiB


2024-09-12 01:11:44,490 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-6ocjymvd


2024-09-12 01:11:44,491 - INFO - -------------------------------------------------


2024-09-12 01:11:44,506 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:62224', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 01:11:44,510 - INFO - Starting worker compute stream, tcp://127.0.0.1:62224


2024-09-12 01:11:44,511 - INFO - Starting Worker plugin shuffle


2024-09-12 01:11:44,517 - INFO - Starting established connection to tcp://127.0.0.1:62226


2024-09-12 01:11:44,519 - INFO -         Registered to:      tcp://127.0.0.1:62215


2024-09-12 01:11:44,521 - INFO - -------------------------------------------------


2024-09-12 01:11:44,522 - INFO - Starting established connection to tcp://127.0.0.1:62215


2024-09-12 01:11:44,587 - INFO - Receive client connection: Client-93f077db-709b-11ef-8748-f4a4751e46e5


2024-09-12 01:11:44,588 - INFO - Starting established connection to tcp://127.0.0.1:62227


2024-09-12 01:11:44,590 - INFO - Dask client initialized with 1 worker.


2024-09-12 01:11:44,665 - INFO - Connected to Snowflake successfully.


2024-09-12 01:11:44,667 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset/cleaned_dataset.csv' loaded successfully.


2024-09-12 01:11:44,706 - INFO - Columns in transformed DataFrame: ['FiscalYear', 'PayrollNumber', 'AgencyID', 'AgencyName', 'EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'WorkLocationBorough', 'TitleCode', 'TitleDescription', 'LeaveStatusasofJune30', 'BaseSalary', 'PayBasis', 'RegularHours', 'RegularGrossPaid', 'OTHours', 'TotalOTPaid', 'TotalOtherPay', 'PayBasisID']


2024-09-12 01:11:44,732 - INFO - Columns in Dim_Date_df: ['DateID', 'Date', 'Year', 'Month', 'Day', 'Quarter']


2024-09-12 01:11:44,737 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 01:11:44,738 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 01:11:44,739 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 01:11:44,760 - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x0000013BADFD87A0>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed')': /session/v1/login-request?request_id=aeb0581d-60e3-4329-a13d-6c675189d42b&databaseName=NYCPAYROLL2_DWH&schemaName=STG&warehouse=COMPUTE_WH&request_guid=ea0e1fad-2eb1-4265-b1ff-e127ea92ed57


2024-09-12 01:11:45,874 - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x0000013BADFDB320>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed')': /session/v1/login-request?request_id=5cb66bcf-9739-40d6-a903-dd0488343ff6&databaseName=NYCPAYROLL2_DWH&schemaName=STG&warehouse=COMPUTE_WH&request_guid=26d12d96-0c90-4d93-972d-7274388f56b6


2024-09-12 01:11:45,887 - ERROR - Error loading data to Snowflake: (snowflake.connector.errors.OperationalError) 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
(Background on this error at: https://sqlalche.me/e/20/e3q8)


2024-09-12 01:11:45,888 - ERROR - ETL pipeline failed: (snowflake.connector.errors.OperationalError) 250001: 250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
(Background on this error at: https://sqlalche.me/e/20/e3q8)


2024-09-12 01:11:46,990 - INFO - Retire worker addresses (0,)


2024-09-12 01:11:46,993 - INFO - Closing Nanny at 'tcp://127.0.0.1:62218'. Reason: nanny-close


2024-09-12 01:11:46,994 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 01:11:47,000 - INFO - Stopping worker at tcp://127.0.0.1:62224. Reason: nanny-close


2024-09-12 01:11:47,002 - INFO - Removing Worker plugin shuffle


2024-09-12 01:11:47,053 - ERROR - Failed to communicate with scheduler during heartbeat.

Traceback (most recent call last):
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\comm\tcp.py", line 225, in read
    frames_nosplit_nbytes_bin = await stream.read_bytes(fmt_size)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\worker.py", line 1250, in heartbeat
    response = await retry_operation(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\utils_comm.py", line 459, in retry_operation
    return await retry(
           ^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\utils_comm.py", line 438, in retry
    return await coro()
           ^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\core.py", line 1256, in send_recv_from_rpc
    return await send_recv(comm=comm, op=key, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\core.py", line 1015, in send_recv
    response = await comm.read(deserializers=deserializers)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\comm\tcp.py", line 236, in read
    convert_stream_closed_error(self, e)
  File "C:\Users\oluwa\AppData\Roaming\Python\Python312\site-packages\distributed\comm\tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) ConnectionPool.heartbeat_worker local=tcp://127.0.0.1:62229 remote=tcp://127.0.0.1:62215>: Stream is closed
2024-09-12 01:11:47,102 - INFO - Connection to tcp://127.0.0.1:62215 has been closed.


2024-09-12 01:11:47,136 - INFO - Received 'close-stream' from tcp://127.0.0.1:62226; closing.


2024-09-12 01:11:47,218 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:62224', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726099907.2184691')


2024-09-12 01:11:47,236 - INFO - Lost all workers


2024-09-12 01:11:47,654 - INFO - Closing scheduler. Reason: unknown


2024-09-12 01:11:47,655 - INFO - Scheduler closing all comms


2024-09-12 01:15:52,743 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:15:54,667 - INFO - Starting load process...


2024-09-12 01:15:55,805 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 01:15:55,923 - INFO - State start


2024-09-12 01:15:56,014 - INFO -   Scheduler at:     tcp://127.0.0.1:63797


2024-09-12 01:15:56,015 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 01:15:56,016 - INFO - Registering Worker plugin shuffle


2024-09-12 01:15:56,093 - INFO -         Start Nanny at: 'tcp://127.0.0.1:63800'


2024-09-12 01:15:59,752 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 01:16:02,120 - INFO -       Start worker at:      tcp://127.0.0.1:63806


2024-09-12 01:16:02,121 - INFO -          Listening to:      tcp://127.0.0.1:63806


2024-09-12 01:16:02,122 - INFO -           Worker name:                          0


2024-09-12 01:16:02,122 - INFO -          dashboard at:            127.0.0.1:63807


2024-09-12 01:16:02,122 - INFO - Waiting to connect to:      tcp://127.0.0.1:63797


2024-09-12 01:16:02,123 - INFO - -------------------------------------------------


2024-09-12 01:16:02,123 - INFO -               Threads:                          4


2024-09-12 01:16:02,124 - INFO -                Memory:                  19.84 GiB


2024-09-12 01:16:02,124 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-svz4wdmv


2024-09-12 01:16:02,133 - INFO - -------------------------------------------------


2024-09-12 01:16:02,149 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:63806', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 01:16:02,154 - INFO - Starting worker compute stream, tcp://127.0.0.1:63806


2024-09-12 01:16:02,156 - INFO - Starting established connection to tcp://127.0.0.1:63808


2024-09-12 01:16:02,157 - INFO -         Registered to:      tcp://127.0.0.1:63797


2024-09-12 01:16:02,161 - INFO - -------------------------------------------------


2024-09-12 01:16:02,163 - INFO - Starting established connection to tcp://127.0.0.1:63797


2024-09-12 01:16:02,205 - INFO - Receive client connection: Client-2d296651-709c-11ef-bb54-f4a4751e46e5


2024-09-12 01:16:02,206 - INFO - Starting established connection to tcp://127.0.0.1:63809


2024-09-12 01:16:02,209 - INFO - Dask client initialized with 1 worker.


2024-09-12 01:16:02,259 - INFO - Connected to Snowflake successfully.


2024-09-12 01:16:02,260 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset/cleaned_dataset.csv' loaded successfully.


2024-09-12 01:16:02,311 - INFO - Columns in transformed DataFrame: ['FiscalYear', 'PayrollNumber', 'AgencyID', 'AgencyName', 'EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'WorkLocationBorough', 'TitleCode', 'TitleDescription', 'LeaveStatusasofJune30', 'BaseSalary', 'PayBasis', 'RegularHours', 'RegularGrossPaid', 'OTHours', 'TotalOTPaid', 'TotalOtherPay', 'PayBasisID']


2024-09-12 01:16:02,339 - INFO - Columns in Dim_Date_df: ['DateID', 'Date', 'Year', 'Month', 'Day', 'Quarter']


2024-09-12 01:16:02,342 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 01:16:02,344 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 01:16:02,344 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 01:16:06,278 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:06,912 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:07,404 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:07,405 - INFO - Table "Dim_Employee" created or already exists.


2024-09-12 01:16:09,654 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:09,657 - INFO - Truncated "Dim_Employee" successfully.


2024-09-12 01:16:13,851 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:13,853 - INFO - Table "Dim_Agency" created or already exists.


2024-09-12 01:16:16,525 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:16,526 - INFO - Truncated "Dim_Agency" successfully.


2024-09-12 01:16:16,922 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:16,923 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-12 01:16:19,381 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:19,383 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-12 01:16:19,800 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:19,802 - INFO - Table "Dim_Date" created or already exists.


2024-09-12 01:16:20,249 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:20,252 - INFO - Truncated "Dim_Date" successfully.


2024-09-12 01:16:21,220 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:21,222 - INFO - Table "FactPayroll" created or already exists.


2024-09-12 01:16:22,140 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:22,141 - INFO - Truncated "FactPayroll" successfully.


2024-09-12 01:16:22,868 - INFO - Number of results in first chunk: 6


2024-09-12 01:16:23,362 - INFO - Number of results in first chunk: 6


2024-09-12 01:16:25,084 - INFO - Number of results in first chunk: 6


2024-09-12 01:16:26,252 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:26,648 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:27,776 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:30,470 - INFO - Number of results in first chunk: 34


2024-09-12 01:16:30,848 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:31,263 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:31,615 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:32,270 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:33,411 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:34,300 - INFO - Number of results in first chunk: 6


2024-09-12 01:16:34,304 - INFO - Dim_Date data loaded successfully.


2024-09-12 01:16:34,839 - INFO - Number of results in first chunk: 8


2024-09-12 01:16:35,270 - INFO - Number of results in first chunk: 8


2024-09-12 01:16:35,672 - INFO - Number of results in first chunk: 6


2024-09-12 01:16:36,226 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:36,888 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:38,504 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:42,824 - INFO - Number of results in first chunk: 34


2024-09-12 01:16:43,947 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:44,766 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:45,417 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:46,037 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:47,124 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:49,172 - INFO - Number of results in first chunk: 6


2024-09-12 01:16:49,176 - INFO - Dim_Employee data loaded successfully.


2024-09-12 01:16:49,787 - INFO - Number of results in first chunk: 2


2024-09-12 01:16:50,194 - INFO - Number of results in first chunk: 2


2024-09-12 01:16:51,238 - INFO - Number of results in first chunk: 6


2024-09-12 01:16:51,628 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:52,349 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:52,653 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:56,954 - INFO - Number of results in first chunk: 34


2024-09-12 01:16:57,422 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:57,975 - INFO - Number of results in first chunk: 0


2024-09-12 01:16:58,487 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:58,969 - INFO - Number of results in first chunk: 1


2024-09-12 01:16:59,330 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:01,357 - INFO - Number of results in first chunk: 6


2024-09-12 01:17:01,363 - INFO - Dim_Agency data loaded successfully.


2024-09-12 01:17:01,970 - INFO - Number of results in first chunk: 2


2024-09-12 01:17:02,381 - INFO - Number of results in first chunk: 2


2024-09-12 01:17:02,787 - INFO - Number of results in first chunk: 6


2024-09-12 01:17:03,914 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:04,596 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:04,981 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:06,598 - INFO - Number of results in first chunk: 34


2024-09-12 01:17:06,890 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:07,194 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:07,889 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:10,164 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:10,589 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:11,900 - INFO - Number of results in first chunk: 6


2024-09-12 01:17:11,901 - INFO - Dim_PayBasis data loaded successfully.


2024-09-12 01:17:12,416 - INFO - Number of results in first chunk: 13


2024-09-12 01:17:12,826 - INFO - Number of results in first chunk: 13


2024-09-12 01:17:13,296 - INFO - Number of results in first chunk: 6


2024-09-12 01:17:13,642 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:14,057 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:14,460 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:17,332 - INFO - Number of results in first chunk: 34


2024-09-12 01:17:17,720 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:19,275 - INFO - Number of results in first chunk: 0


2024-09-12 01:17:19,668 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:20,912 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:22,140 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:24,289 - INFO - Number of results in first chunk: 6


2024-09-12 01:17:24,291 - INFO - FactPayroll data loaded successfully.


2024-09-12 01:17:24,897 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:24,898 - INFO - All data loaded successfully.


2024-09-12 01:17:25,222 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:25,223 - INFO - Closing Snowflake connection.


2024-09-12 01:17:25,318 - INFO - Retire worker addresses (0,)


2024-09-12 01:17:25,320 - INFO - Closing Nanny at 'tcp://127.0.0.1:63800'. Reason: nanny-close


2024-09-12 01:17:25,321 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 01:17:25,322 - INFO - Stopping worker at tcp://127.0.0.1:63806. Reason: nanny-close


2024-09-12 01:17:25,323 - INFO - Removing Worker plugin shuffle


2024-09-12 01:17:25,330 - INFO - Connection to tcp://127.0.0.1:63797 has been closed.


2024-09-12 01:17:25,330 - INFO - Received 'close-stream' from tcp://127.0.0.1:63808; closing.


2024-09-12 01:17:25,337 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:63806', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726100245.3368223')


2024-09-12 01:17:25,338 - INFO - Lost all workers


2024-09-12 01:17:26,112 - INFO - Closing scheduler. Reason: unknown


2024-09-12 01:17:26,114 - INFO - Scheduler closing all comms


2024-09-12 01:17:26,123 - INFO - Dask client shutdown complete.


2024-09-12 01:17:26,125 - INFO - Executing stored procedure in Snowflake...


2024-09-12 01:17:26,130 - INFO - Connected to Snowflake successfully.


2024-09-12 01:17:26,135 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 01:17:26,136 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 01:17:26,138 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 01:17:30,186 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:30,638 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:38,829 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:38,830 - INFO - Stored procedure executed successfully.


2024-09-12 01:17:39,238 - INFO - Number of results in first chunk: 1


2024-09-12 01:17:39,239 - INFO - ETL pipeline completed successfully.


2024-09-12 01:17:39,241 - INFO - closed


2024-09-12 01:17:39,243 - INFO - No async queries seem to be running, deleting session


2024-09-12 01:17:39,650 - INFO - closed


2024-09-12 01:17:39,651 - INFO - No async queries seem to be running, deleting session


2024-09-12 15:18:24,587 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 15:18:32,787 - INFO - Starting extraction process...


2024-09-12 15:18:32,790 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer?restype=REDACTED&comp=REDACTED&prefix=REDACTED'
Request method: 'GET'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e4269038-7111-11ef-8079-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-12 15:18:34,330 - INFO - Response status: 200
Response headers:
    'Transfer-Encoding': 'chunked'
    'Content-Type': 'application/xml'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ba4c7d9e-401e-002d-1c1e-051be4000000'
    'x-ms-client-request-id': 'e4269038-7111-11ef-8079-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'Date': 'Thu, 12 Sep 2024 14:18:34 GMT'


2024-09-12 15:18:34,350 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2021.csv'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e5149b3e-7111-11ef-98c6-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-12 15:18:34,708 - INFO - Response status: 206
Response headers:
    'Content-Length': '16843'
    'Content-Type': 'text/csv'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Thu, 12 Sep 2024 14:11:19 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DCD334C6282B10"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ba4c7e07-401e-002d-711e-051be4000000'
    'x-ms-client-request-id': 'e5149b3e-7111-11ef-98c6-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-blob-content-md5': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'x-ms-acl': 'REDACTED'
    'Date': 'Thu, 12 Sep 2024 14:18:34 GMT'


2024-09-12 15:18:34,711 - INFO - Successfully downloaded the latest file: Dataset/raw_payroll_data/nycpayroll_2021.csv to All_Dataset/Raw_Dataset\nycpayroll_2021.csv


2024-09-12 15:18:34,712 - INFO - Source blob URL: https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2021.csv


2024-09-12 15:18:34,713 - INFO - Archive blob path: Dataset/archived_payroll_data/nycpayroll_2021.csv


2024-09-12 15:18:34,714 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/archived_payroll_data/nycpayroll_2021.csv'
Request method: 'PUT'
Request headers:
    'x-ms-copy-source': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e54c6f12-7111-11ef-b1d6-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-12 15:18:35,088 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Thu, 12 Sep 2024 14:18:35 GMT'
    'ETag': '"0x8DCD335C9BB0E38"'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ba4c7e64-401e-002d-3a1e-051be4000000'
    'x-ms-client-request-id': 'e54c6f12-7111-11ef-b1d6-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-copy-id': 'REDACTED'
    'x-ms-copy-status': 'REDACTED'
    'Date': 'Thu, 12 Sep 2024 14:18:34 GMT'


2024-09-12 15:18:35,090 - INFO - Request URL: 'https://2ndnycpayrollstorageacct.blob.core.windows.net/payrolldatacontainer/Dataset/raw_payroll_data/nycpayroll_2021.csv'
Request method: 'DELETE'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-blob/12.22.0 Python/3.12.4 (Windows-11-10.0.22631-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e585b537-7111-11ef-bd82-f4a4751e46e5'
    'Authorization': 'REDACTED'
No body was attached to the request


2024-09-12 15:18:35,472 - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'ba4c7ecb-401e-002d-1a1e-051be4000000'
    'x-ms-client-request-id': 'e585b537-7111-11ef-bd82-f4a4751e46e5'
    'x-ms-version': 'REDACTED'
    'x-ms-delete-type-permanent': 'REDACTED'
    'x-ms-deletion-id': 'REDACTED'
    'Date': 'Thu, 12 Sep 2024 14:18:35 GMT'


2024-09-12 15:18:35,473 - INFO - Archived and deleted the original file: Dataset/raw_payroll_data/nycpayroll_2021.csv


2024-09-12 15:18:35,474 - INFO - File Dataset/raw_payroll_data/nycpayroll_2021.csv processed and archived successfully.


2024-09-12 15:18:35,474 - INFO - Starting transformation process...


2024-09-12 15:18:35,476 - INFO - Scanning directory for files: All_Dataset\Raw_Dataset


2024-09-12 15:18:35,476 - INFO - Latest file found: All_Dataset\Raw_Dataset\nycpayroll_2021.csv


2024-09-12 15:18:35,477 - INFO - Processing latest file: All_Dataset\Raw_Dataset\nycpayroll_2021.csv


2024-09-12 15:18:35,478 - INFO - Starting data transformation


2024-09-12 15:18:35,479 - INFO - Loading raw data from C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Raw_Dataset\nycpayroll_2021.csv


2024-09-12 15:18:37,387 - INFO - Transformed data saved to C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline\All_Dataset\Cleaned_Dataset\cleaned_dataset.csv


2024-09-12 15:18:37,412 - INFO - dim_date data generated and saved!


2024-09-12 15:18:37,413 - INFO - Starting load process...


2024-09-12 15:18:40,408 - INFO - To route to workers diagnostics web server please install jupyter-server-proxy: python -m pip install jupyter-server-proxy


2024-09-12 15:18:40,460 - INFO - State start


2024-09-12 15:18:40,508 - INFO -   Scheduler at:     tcp://127.0.0.1:63085


2024-09-12 15:18:40,509 - INFO -   dashboard at:  http://127.0.0.1:8787/status


2024-09-12 15:18:40,510 - INFO - Registering Worker plugin shuffle


2024-09-12 15:18:40,573 - INFO -         Start Nanny at: 'tcp://127.0.0.1:63088'


2024-09-12 15:18:43,775 - INFO - Current working directory: C:\Users\oluwa\OneDrive\Documents\Data Engineering Training - 10Alytics\Project - Capstone\NYCPayroll_Pipeline


2024-09-12 15:18:45,590 - INFO -       Start worker at:      tcp://127.0.0.1:63094


2024-09-12 15:18:45,598 - INFO -          Listening to:      tcp://127.0.0.1:63094


2024-09-12 15:18:45,598 - INFO -           Worker name:                          0


2024-09-12 15:18:45,600 - INFO -          dashboard at:            127.0.0.1:63095


2024-09-12 15:18:45,601 - INFO - Waiting to connect to:      tcp://127.0.0.1:63085


2024-09-12 15:18:45,601 - INFO - -------------------------------------------------


2024-09-12 15:18:45,601 - INFO -               Threads:                          4


2024-09-12 15:18:45,602 - INFO -                Memory:                  19.84 GiB


2024-09-12 15:18:45,603 - INFO -       Local Directory: C:\Users\oluwa\AppData\Local\Temp\dask-scratch-space\worker-l_yqlq7i


2024-09-12 15:18:45,603 - INFO - -------------------------------------------------


2024-09-12 15:18:45,608 - INFO - Register worker <WorkerState 'tcp://127.0.0.1:63094', name: 0, status: init, memory: 0, processing: 0>


2024-09-12 15:18:45,611 - INFO - Starting worker compute stream, tcp://127.0.0.1:63094


2024-09-12 15:18:45,612 - INFO - Starting established connection to tcp://127.0.0.1:63096


2024-09-12 15:18:45,614 - INFO -         Registered to:      tcp://127.0.0.1:63085


2024-09-12 15:18:45,615 - INFO - -------------------------------------------------


2024-09-12 15:18:45,617 - INFO - Starting established connection to tcp://127.0.0.1:63085


2024-09-12 15:18:45,663 - INFO - Receive client connection: Client-e6e82ad9-7111-11ef-ac94-f4a4751e46e5


2024-09-12 15:18:45,664 - INFO - Starting established connection to tcp://127.0.0.1:63097


2024-09-12 15:18:45,665 - INFO - Dask client initialized with 1 worker.


2024-09-12 15:18:45,681 - INFO - Connected to Snowflake successfully.


2024-09-12 15:18:45,684 - INFO - Transformed NYC Payroll CSV file 'All_Dataset/Cleaned_Dataset/cleaned_dataset.csv' loaded successfully.


2024-09-12 15:18:45,787 - INFO - Columns in transformed DataFrame: ['FiscalYear', 'PayrollNumber', 'AgencyID', 'AgencyName', 'EmployeeID', 'LastName', 'FirstName', 'AgencyStartDate', 'WorkLocationBorough', 'TitleCode', 'TitleDescription', 'LeaveStatusasofJune30', 'BaseSalary', 'PayBasis', 'RegularHours', 'RegularGrossPaid', 'OTHours', 'TotalOTPaid', 'TotalOtherPay', 'PayBasisID']


2024-09-12 15:18:45,797 - INFO - Columns in Dim_Date_df: ['DateID', 'Date', 'Year', 'Month', 'Day', 'Quarter']


2024-09-12 15:18:45,799 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 15:18:45,801 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 15:18:45,802 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 15:18:50,406 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:50,937 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:51,393 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:51,395 - INFO - Table "Dim_Employee" created or already exists.


2024-09-12 15:18:51,904 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:51,905 - INFO - Truncated "Dim_Employee" successfully.


2024-09-12 15:18:52,926 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:52,927 - INFO - Table "Dim_Agency" created or already exists.


2024-09-12 15:18:53,628 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:53,628 - INFO - Truncated "Dim_Agency" successfully.


2024-09-12 15:18:54,590 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:54,595 - INFO - Table "Dim_PayBasis" created or already exists.


2024-09-12 15:18:55,729 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:55,729 - INFO - Truncated "Dim_PayBasis" successfully.


2024-09-12 15:18:56,076 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:56,077 - INFO - Table "Dim_Date" created or already exists.


2024-09-12 15:18:56,600 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:56,600 - INFO - Truncated "Dim_Date" successfully.


2024-09-12 15:18:57,128 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:57,129 - INFO - Table "FactPayroll" created or already exists.


2024-09-12 15:18:57,629 - INFO - Number of results in first chunk: 1


2024-09-12 15:18:57,630 - INFO - Truncated "FactPayroll" successfully.


2024-09-12 15:18:58,816 - INFO - Number of results in first chunk: 6


2024-09-12 15:18:59,132 - INFO - Number of results in first chunk: 6


2024-09-12 15:18:59,781 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:00,125 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:00,454 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:00,832 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:03,074 - INFO - Number of results in first chunk: 34


2024-09-12 15:19:03,436 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:03,746 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:04,131 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:05,129 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:05,942 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:07,079 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:07,081 - INFO - Dim_Date data loaded successfully.


2024-09-12 15:19:07,794 - INFO - Number of results in first chunk: 8


2024-09-12 15:19:08,865 - INFO - Number of results in first chunk: 8


2024-09-12 15:19:09,302 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:09,834 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:10,114 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:10,422 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:12,662 - INFO - Number of results in first chunk: 34


2024-09-12 15:19:13,116 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:13,423 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:13,735 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:14,210 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:15,058 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:16,575 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:16,578 - INFO - Dim_Employee data loaded successfully.


2024-09-12 15:19:17,145 - INFO - Number of results in first chunk: 2


2024-09-12 15:19:17,887 - INFO - Number of results in first chunk: 2


2024-09-12 15:19:18,490 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:18,891 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:19,820 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:20,933 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:22,590 - INFO - Number of results in first chunk: 34


2024-09-12 15:19:22,896 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:23,196 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:24,211 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:25,138 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:26,063 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:26,977 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:26,981 - INFO - Dim_Agency data loaded successfully.


2024-09-12 15:19:28,100 - INFO - Number of results in first chunk: 2


2024-09-12 15:19:28,568 - INFO - Number of results in first chunk: 2


2024-09-12 15:19:29,557 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:30,121 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:30,414 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:30,807 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:31,984 - INFO - Number of results in first chunk: 34


2024-09-12 15:19:32,375 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:32,910 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:33,458 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:34,961 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:35,861 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:37,275 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:37,277 - INFO - Dim_PayBasis data loaded successfully.


2024-09-12 15:19:37,917 - INFO - Number of results in first chunk: 13


2024-09-12 15:19:38,448 - INFO - Number of results in first chunk: 13


2024-09-12 15:19:38,840 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:39,226 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:39,715 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:40,049 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:41,216 - INFO - Number of results in first chunk: 34


2024-09-12 15:19:41,769 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:42,061 - INFO - Number of results in first chunk: 0


2024-09-12 15:19:42,408 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:42,881 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:43,231 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:44,614 - INFO - Number of results in first chunk: 6


2024-09-12 15:19:44,615 - INFO - FactPayroll data loaded successfully.


2024-09-12 15:19:45,040 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:45,041 - INFO - All data loaded successfully.


2024-09-12 15:19:45,315 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:45,317 - INFO - Closing Snowflake connection.


2024-09-12 15:19:45,409 - INFO - Retire worker addresses (0,)


2024-09-12 15:19:45,411 - INFO - Closing Nanny at 'tcp://127.0.0.1:63088'. Reason: nanny-close


2024-09-12 15:19:45,412 - INFO - Nanny asking worker to close. Reason: nanny-close


2024-09-12 15:19:45,413 - INFO - Stopping worker at tcp://127.0.0.1:63094. Reason: nanny-close


2024-09-12 15:19:45,414 - INFO - Removing Worker plugin shuffle


2024-09-12 15:19:45,417 - INFO - Received 'close-stream' from tcp://127.0.0.1:63096; closing.


2024-09-12 15:19:45,417 - INFO - Connection to tcp://127.0.0.1:63085 has been closed.


2024-09-12 15:19:45,418 - INFO - Remove worker <WorkerState 'tcp://127.0.0.1:63094', name: 0, status: closing, memory: 0, processing: 0> (stimulus_id='handle-worker-cleanup-1726150785.4187515')


2024-09-12 15:19:45,424 - INFO - Lost all workers


2024-09-12 15:19:46,101 - INFO - Closing scheduler. Reason: unknown


2024-09-12 15:19:46,102 - INFO - Scheduler closing all comms


2024-09-12 15:19:46,107 - INFO - Dask client shutdown complete.


2024-09-12 15:19:46,108 - INFO - Executing stored procedure in Snowflake...


2024-09-12 15:19:46,110 - INFO - Connected to Snowflake successfully.


2024-09-12 15:19:46,112 - INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.4, Platform: Windows-11-10.0.22631-SP0


2024-09-12 15:19:46,117 - INFO - Connecting to GLOBAL Snowflake domain


2024-09-12 15:19:46,118 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.


2024-09-12 15:19:48,821 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:49,113 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:55,337 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:55,338 - INFO - Stored procedure executed successfully.


2024-09-12 15:19:55,660 - INFO - Number of results in first chunk: 1


2024-09-12 15:19:55,663 - INFO - ETL pipeline completed successfully.


2024-09-12 15:19:55,664 - INFO - closed


2024-09-12 15:19:55,664 - INFO - No async queries seem to be running, deleting session


2024-09-12 15:19:55,940 - INFO - closed


2024-09-12 15:19:55,941 - INFO - No async queries seem to be running, deleting session


